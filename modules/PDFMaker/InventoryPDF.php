<?php

require_once("modules/PDFMaker/PDFMakerUtils.php");
require_once "modules/PDFMaker/PDFMaker.php";
Debugger::GetInstance()->Init();

$memory_limit = substr(ini_get("memory_limit"), 0, -1);
if ($memory_limit < 256) {
    ini_set("memory_limit", "256M");
}
global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c;
$x0b="\x61r\162\141\x79\x5f\153\x65y\163"; $x0c="\x61rr\x61y_\x70\x75\163h"; $x0d="arra\x79\137\155\x65\162\x67e"; $x0e="arr\141\x79\137\163\165\155"; $x0f="\143\141\x6c\x6c\x5f\165s\x65\162\137\146\x75\156\x63\x5farray"; $x10="c\x6f\x75\156\164"; $x11="\144a\164e"; $x12="\145\170\x70\154o\144\x65"; $x13="\x66\151\x6c\145_\x65\x78is\x74\x73"; $x14="g\154ob"; $x15="\150\164\155\154\137en\164i\x74y\137\x64e\x63\157\x64\145"; $x16="\150\x74\x6d\154\145n\x74\x69t\x69e\163"; $x17="i\x63\x6fn\166"; $x18="i\155p\x6c\157de"; $x19="i\156\x5f\141r\x72\x61\x79"; $x1a="\151\163_\156\165\155\145ri\x63"; $x1b="\151\163\137\x6fbj\145c\164"; $x1c="\x6d\1445"; $x1d="n\154\062\142r"; $x1e="\156\x75mber_\146o\162\155at"; $x1f="\160\x72\x65\147\137\155\x61\164c\x68\x5f\141\154l"; $x20="\x72\x6f\165\x6e\144"; $x21="\x72\x74r\151\155"; $x22="\163\x70\162\151\x6e\164\146"; $x23="s\x74\x72\137\x72\x65pl\x61\x63\x65"; $x24="\x73\x74\x72\137\151r\145p\154\141\143\x65"; $x25="\163\164\x72l\x65\x6e"; $x26="s\164\162i\160_\x74\141g\163"; $x27="\163\164\x72\164\x6fu\160p\145r"; $x28="\163\x74\162\160os"; $x29="\x73\x74\162\x74olo\167\x65r"; $x2a="\163\x74\162\x73\x74r"; $x2b="s\165\142\x73\x74\x72"; $x2c="tr\151\x6d"; 
class PDFContent {private $templateid;private $module;private $language;private $focus;private $db;private $mod_strings;private $def_charset;private $site_url;private $decimal_point;private $thousands_separator;private $decimals;public $pagebreak;private $rowbreak;private $ignored_picklist_values = array();private $header;private $footer;private $body;private $content;private $filename;private $templatename;private $type;private $section_sep = "\046#%ITS%%\x25\x40@@\x25%%\111T\123\045\043\046";private $replacements;private $inventory_table_array = Array("P\165\x72c\150\x61se\117\162d\x65\162" => "\x76\164i\x67\x65\162\137\x70\165\162\143\x68\x61s\x65\157\162\144\x65r","\123\141\154e\163\117\162\x64\145\x72" => "\x76ti\x67er\137\x73\141\154\x65\163\x6f\x72\x64er","\x51uo\164\145\x73" => "\166\x74i\x67e\162_qu\157te\x73","\111\156\x76\x6f\x69\143\x65" => "\x76\x74i\147\x65r\137\x69\156vo\151\x63\145","\111\163\163\x75\x65\x63\141\x72\x64\x73" => "\x76\164\x69\x67\145\x72_i\x73\x73\x75ec\141\x72\x64\163","\122\145\143ei\x70tc\141r\x64s" => "\x76t\151\147\145r_recei\x70tcar\x64\163","C\162\x65d\151\164n\x6f\164\145" => "vt\x69\147e\x72_\143\x72\145dit\156o\x74\145","\123\x74\157\162\x6e\157\111\156\166\157\151\143\145" => "\166\x74i\147\145r\137\163\164\157\x72\x6eoi\156\x76o\x69ce");private $inventory_id_array = Array("\x50u\x72\x63h\141\163e\117r\x64\145\x72" => "p\x75\162\143h\x61\163\145o\162\144\145\162\x69\144","\x53\x61l\x65sO\x72d\145\162" => "\163\x61\154\x65s\157\162\x64\x65\162\x69d","\121\165\157\164e\163" => "\161uo\x74\145\151d","\111\x6e\166o\x69ce" => "i\156v\x6fi\143\145\x69\x64","\111\163\x73\165\x65\x63\x61rd\163" => "\151\x73s\165e\x63a\x72\x64\x69d","\x52\145\143\145\x69\160tc\x61rds" => "r\x65c\145\x69\x70tc\141\x72\x64\151\144","\103\162\145\144\151tno\x74\x65" => "c\x72\x65\144i\x74\156\157te_id","\123t\x6f\162\x6e\157I\x6e\166\x6fi\x63e" => "\x73t\157\162\156\x6fi\156v\157\151c\145\x5f\x69\144");private $org_cols = array("\157r\x67a\x6e\151\172\x61\x74\x69\157n\x6e\x61me" => "\x43\x4f\x4dP\x41\116\131\x5f\116\x41\x4dE","\x61\x64d\x72\x65s\x73" => "\x43OM\x50\101\116\131_\x41\104\104R\x45S\x53","\x63\x69ty" => "C\117\x4d\x50\101\116\x59\x5f\103I\x54Y","s\164\141\x74e" => "\x43\x4f\115\120\x41\116Y_S\124\101\124\105","c\157d\145" => "C\117\x4d\120\101\116\x59_\132\x49P","\143\x6f\165n\164\x72y" => "\103O\115\x50\101\116\131_C\x4f\125NT\122\131","\x70\150o\156\145" => "\103O\115P\101N\x59\x5fPHO\116\105","fa\x78" => "\x43\x4fM\x50A\116Y\x5f\x46A\130","\167\145b\163\x69\164\x65" => "C\x4f\115\120\x41\116Y\x5fW\105\x42\123I\x54E","l\x6f\x67\x6f" => "\x43O\x4d\120\x41\x4eY_\x4c\117\x47\117",);public $bridge2mpdf = array();private $relBlockModules = array();function __construct($templateid, $module, $focus, $language) { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $db = "\x61d\142";$mod = "\x6do\x64_\x73\x74\x72ing\x73";$vcv = "vt\151\147e\x72\137c\165\x72\x72en\164\x5f\166ers\x69\x6f\156";$salt = "\163\x69t\x65\x5f\125RL";$dc = "\x64\x65\x66\141\165lt_ch\141\x72\x73\145\164";global $$db, $$mod, $$vcv, $$salt, $$dc, $PDFMaker_template_id;$this->db = &$$db;$this->mod_strings = $$mod;$this->def_charset = $$dc;$this->templateid = $templateid;$PDFMaker_template_id = $this->templateid;$this->module = $module;$this->focus = $focus;$this->language = $language;$result = $$db->query("\123\x45\114\x45CT\x20\154\x69\143e\156\x73\x65\x20\x46RO\x4d\x20\166\x74\151ge\x72\137p\144\146ma\153e\x72\x5f\166e\162\163\151on\040\127\x48\x45R\x45 \166e\x72\163\151\157\x6e\x3d'" . $$vcv . "'");if ($$db->query_result($result, 0, "\154\x69\x63e\x6es\145") == $this->x2a($$salt)) {$this->type = "\x70\162\x6f\146\x65s\x73i\x6f\156a\154";} elseif ($$db->query_result($result, 0, "\154\151c\x65ns\145") == $this->x2a("\142\x61\x73ic\x2f" . $$salt) && ($module == "P\x75rc\x68\141\x73\x65O\162d\145\x72" || $module == "\x53\141\154\x65\163\117\162de\162" || $module == "\x51\165\157t\x65s" || $module == "Invo\x69\143e")) {$this->type = "\x62\x61\163i\143";} else {$this->type = "i\156val\x69d";}$this->x16();$this->x17();$this->bridge2mpdf["re\143\x6frd"] = $this->focus->id;$this->bridge2mpdf["\x74\x65\x6dp\154\141\x74e\151\x64"] = $this->templateid;$this->rowbreak = "\x3c\x72\157\167\142r\145\141\153\x20/\x3e";}public function getContent() { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; require_once("\143\x6c\x61\x73\163e\163/si\155p\154\x65_ht\155\154\x5fdom\056php");$img_root = "i\x6d\x67_\x72\x6f\157\164_\x64\x69r\145ct\157\x72y";$vcv = "\x76\x74ig\x65\162_\x63urre\156t\x5fvers\x69\157\156";global $$img_root, $$vcv;if ($this->module == 'Calendar')$this->replacements = Array();if ($this->type == "\160r\x6f\x66e\x73si\157\156\x61\x6c" || $this->type == "b\141si\143") {$this->content = $this->body;$this->content = $this->header . $this->section_sep;$this->content .= $this->body . $this->section_sep;$this->content .= $this->footer;$this->replacements["\046nb\x73\x70;"] = "\040";$this->replacements["#\043\x50\x41\x47\x45\x23#"] = "\173PA\x47\105\116\x4f\x7d";$this->replacements["\x23#PA\107E\x53\043\x23"] = "\x7b\x6e\142}";$this->replacements["\x23#\x44D\055\115\x4d\x2dY\131Y\131#\x23"] = $x11("d\x2dm\x2d\x59");$this->replacements["#\043\104D\x2e\115\115\x2eY\131\x59Y\x23\043"] = $x11("\x64\x2em.\x59");$this->replacements["#\x23\x4dM-D\x44\x2d\131\131\131\131\043\x23"] = $x11("\x6d-\144-\131");$this->replacements["\x23\043YYY\x59\055\x4d\x4d\055D\x44##"] = $x11("\131-\155\055\144");$this->replacements["\x73r\x63\075\047"] = "s\162\143\075'" . $$img_root;$this->replacements["\x24" . $x27($this->module) . "_\x43RM\111\104$"] = $this->focus->id;if ($$vcv == '5.2.1') {$displayValueCreated = getDisplayDate($this->focus->column_fields['createdtime']);$displayValueModified = getDisplayDate($this->focus->column_fields['modifiedtime']);} else {$createdtime = new DateTimeField($this->focus->column_fields['createdtime']);$displayValueCreated = $createdtime->getDisplayDateTimeValue();$modifiedtime = new DateTimeField($this->focus->column_fields['modifiedtime']);$displayValueModified = $modifiedtime->getDisplayDateTimeValue();}$this->replacements["\x24" . $x27($this->module) . "\137\x43R\105A\124E\104\x54\x49\115\x45_\104A\x54ETI\x4d\105$"] = $displayValueCreated;$this->replacements["$" . $x27($this->module) . "\x5f\x4dO\x44I\x46I\x45\104\124IME_\x44A\124\x45\124\x49\115E\044"] = $displayValueModified; $this->x36(); $this->x15();$this->content = $x15($this->content, ENT_QUOTES, $this->def_charset); $html = str_get_html($this->content); foreach ($html->find("\144i\x76\133\x73\x74\x79\154\x65\x5e\075p\x61\147e-\142\162\145a\x6b\055\x61\146t\x65\162\x5d") as $div_page_break) {$div_page_break->outertext = $this->pagebreak;$this->content = $html->save();} foreach ($html->find("\144iv\133\163\x74\171\x6c\x65\x5e=\120A\x47\105\x2d\x42R\105\101\113\055A\x46\124\x45\x52\x5d") as $div_page_break) {$div_page_break->outertext = $this->pagebreak;$this->content = $html->save();}$this->x2f();$this->x30();$this->x31();$this->x0b();$this->x2b();$this->x10($this->module, $this->focus);$this->x0d();if ($this->focus->column_fields["ass\x69\x67\x6eed_us\145\162_\151d"] == "") {$this->focus->column_fields["ass\x69g\156\145d_\x75\x73e\x72\x5fi\144"] = $this->db->query_result($this->db->query("\123\105\114\x45\x43T\040s\155o\167\x6e\145ri\x64 \x46\122\x4f\115\040vt\x69g\145\x72_\143rm\145n\x74i\164y\040WHE\122\x45 c\x72m\x69\x64=" . $this->focus->id), 0, "\163\155\x6f\x77n\x65rid");}$this->x2d(); $this->x0e();$this->x11();$this->x12();$this->x13();$this->x14();$this->x35(); if ($x27($this->def_charset) != "UT\x46-\070") {$this->content = $x17($this->def_charset, "\x55\x54\106\0558//\x54\122A\x4e\123L\x49\x54", $this->content);}if ($this->type == "p\x72\157\146es\163\151o\x6eal")$this->x28();$PDF_content = array();list($PDF_content["\150\145\x61d\145\162"], $PDF_content["\142\157\x64y"], $PDF_content["\146\x6fo\x74\x65r"]) = $x12($this->section_sep, $this->content);}else {$error_text = "\111nval\x69\144\x20l\151ce\x6es\145\040\153e\171\x21\040Pl\145\x61\163\x65 c\x6f\156\x74\141ct\x20\x74\x68\145 \166\x65\156d\157r\040\157\146 \120\x44F\040M\x61\153\145\162.";$PDF_content = array("hea\x64\x65r" => "<\143e\x6e\x74\x65\162\x3e\x45RR\117\x52\074\057c\145\x6e\x74er\076", "bod\171" => $error_text, "\146\x6fo\x74\x65\x72" => "");}return $PDF_content;}public function getSettings() { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $sql = "\x53\105\114\105\x43\x54\040\x28\155a\x72\x67\151\156_t\x6f\x70 *\x20\x31\060\051\040\x41\x53\040\155\141rg\151\x6e\x5f\x74o\160,
\x0a\x20\040 \x20\040 \040 \040\x20 \040\040   \x20\040 \x20 \x28m\x61\x72\x67\x69\x6e_\142\157t\164\x6f\x6d \x2a\x20\x31\060)\040\101S \x6da\x72g\151\x6e\137\x62\157t\x74\x6f\x6d\054
\x20 \x20\x20\040\x20    \x20\040\x20 \040\x20\x20 \040 \040\050m\141rg\151\x6e_\154\x65\146\164 *\040\0610\051\040\101S\040\155a\162\x67\151n_\x6ce\146t\054\x0d
\x20\x20\040  \x20\040\040  \040\x20\x20\040\040\040\040\040\x20\x20\x20(\155\x61\x72\147i\x6e\x5fri\147ht*\x31\060\051\040AS m\x61\x72\147i\x6e_\162\151\147\150\x74\054\015
 \040 \x20\x20  \x20\040\x20 \x20 \040   \x20\x20\040\x20\x66o\162\155\141\164,\x0d\012 \040\040\x20\x20\040 \x20 \x20 \x20\040\x20\x20\x20\x20 \x20\040\040\x6f\162\x69\145\x6et\x61t\151\x6f\x6e,
\040 \040      \x20\040 \x20\040  \040\040\x20\x20\040en\143odin\x67,
\012\040\040\040\x20  \040\x20  \040\x20\040\040\x20   \x20  disp\137\x68\x65a\144e\x72\054\040d\151s\x70_f\157\x6ft\x65r\015\x0a\040\040\x20 \x20\x20 \040\x20 \040\040 \040\106R\117\115\040\166\164\x69g\145r\137p\144fm\x61\x6b\x65\162\137\x73\x65\164\x74\x69\156\x67\x73 WHER\105\040t\x65\x6d\160late\151\x64\x20=\x20'" . $this->templateid . "'";$result = $this->db->query($sql);$Settings = $this->db->fetchByAssoc($result, 1);return $Settings;}private function x0b() { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $vcv = "\x76\x74\x69g\145\x72\137\143\x75\x72re\x6e\x74\x5f\x76\145r\163\x69\x6f\156";global $$vcv;$field_inf = "\x5ff\151e\154\144\151\156\146\x6f\x5f\x63\141\x63\150\x65"; $sql = "S\105\x4c\105\103\x54\040\146ie\154\x64\x69d\x2c\x20\x72e\x6c\155o\144\x75\154\x65\040\106R\117\x4d\040\x76\x74\151\147\x65r\137\146i\x65\154\x64\155o\144u\154\x65\162\x65l";$result = $this->db->query($sql);$fieldModRel = array();while ($row = $this->db->fetchByAssoc($result)) {$fieldModRel[$row["f\x69\145\154di\144"]][] = $row["\x72e\154mo\144\x75\154e"];}$sql = "SE\x4c\105C\x54\040\x66iel\x64\x69\144,\040\146\151\145\154d\156\x61m\x65\x2c\040\x75\151\x74\x79p\x65\x2c \x63\x6f\x6c\x75m\x6e\156\x61\155\145\015\x0a\x20 \x20\040\x20 \040\040\040\040\x20\040\x20\040\x46\122\x4fM\040\x76\x74i\x67\x65\x72\x5ff\151e\154\144\x0d\012\040 \x20 \x20\040    \x20  \x20\x57\x48E\x52\105\040t\141\142\151\x64\x3d" . getTabId($this->module) . " \x41\x4e\x44\040(\x64\151\163p\154a\171ty\160\x65\x20\041\x3d\x20\x33 \x4fR\x20\x66i\145\154\144\151d\x20= \0664)";$result = $this->db->query($sql);$num_rows = $this->db->num_rows($result);if ($num_rows > 0) {$tacModules = array();$tac4you = $x1a(getTabId("\124a\1434\171\157\165"));if ($tac4you == true) {$tacSql = "S\105\x4c\x45CT \x74\x61\143\064\171\x6fu_\x6d\x6f\x64\x75\154e \x46\x52\117\x4d\040\x76\164\x69g\145\162_\164\x61\143\064y\157\165\137\x6dodu\x6ce\x20WHE\122\x45\040\160re\x73\145\x6e\143e \x3d\x20\x31";$tacResult = $this->db->query($tacSql);while ($tacRow = $this->db->fetchByAssoc($tacResult))$tacModules[$tacRow["\x74ac\x34\x79ou\x5f\155\x6f\144ule"]] = $tacRow["\x74a\143\064\171\x6fu_m\x6f\144\165\154\x65"];}$descModules = array();$desc4you = $x1a(getTabId("D\x65sc\x72\x69\x70\x74\x69\x6fns\x34\171\157\x75"));if ($desc4you == true) {$descSql = "\123\105\114E\x43\124 b\x2ena\155\145\x20FROM\x20\166t\x69\x67\145r\137\x6c\x69\x6e\153\x73 AS\x20\141\015\012\040   \040 \x20  \x20       \x20\040\x20\x20\040  \040I\x4e\x4eE\x52 JOI\116\x20\166\164\x69g\x65\x72\137\x74ab\x20A\123 \x62 \x55SI\116G\x20\050\164a\142\x69\x64)\x0d\x0a \040  \x20  \040\x20\040    \040\x20\040 \040 \x20\x20\040 \040\x57\x48E\122\105\x20\x6c\151\156\x6bt\171\x70\x65\x20\x3d 'DE\124A\x49\x4c\126\x49EW\127\x49\x44\107E\x54'
\012\040\040\x20  \040\040\040\040 \x20\040\x20  \040\040\x20\040\040\x20\040\x20\040\040\x20  AN\104\x20\154\151\x6e\x6bur\x6c =\040'b\x6c\157\143\153\072//M\x6f\144D\x65\163cr\x69p\x74\151o\x6e\x73\x34\x79\x6f\x75:m\157\144u\x6ces\057\104esc\x72i\160\164\151\x6fn\x734\171\x6f\165\x2f\x4d\157\x64\x44\x65\x73c\162i\x70\x74i\x6f\156\163\064yo\165\x2ep\x68p'";$descResult = $this->db->query($descSql);while ($descRow = $this->db->fetchByAssoc($descResult))$descModules[$descRow["\156a\155\x65"]] = $descRow["\156\x61\155e"];}$ModCommentsModules = array();$ModComments = $x1a(getTabId("\x4d\x6fdCo\155\155e\x6e\x74\163"));if ($ModComments == true) {$sql = "\123\x45\x4c\105\x43\124\x20re\154\155\x6f\144u\154\145\040\x46\122\x4f\115\040vti\147e\162_f\x69e\154\144m\x6fdu\154e\x72e\154\x20\127\110\x45\x52\105\040mo\144u\x6c\x65\x3d'M\x6fdC\x6f\155\x6den\164s'\x20\101N\x44\x20relm\x6f\x64u\x6c\145 \x21\075\040'\115\x6f\x64\103\x6f\x6d\x6d\x65\x6e\164\x73'";$modCommResult = $this->db->query($sql);while ($row = $this->db->fetchByAssoc($modCommResult))$ModCommentsModules[$row["\x72\145\154\155o\x64u\x6c\x65"]] = $row["\x72\x65\x6cmo\144\165\154\145"];}while ($row = $this->db->fetch_array($result)) {$related_module = "";$columnname = $row["\x63\x6f\x6c\165m\x6e\x6ea\155e"];$fk_record = $this->focus->column_fields[$row["\146i\145\x6c\144\x6e\x61\x6de"]];switch ($row["ui\164\171p\145"]) {case "5\061": $related_module = "\101\143\x63\x6fu\x6e\164\x73";break;case "57": $related_module = "\x43\157\x6e\x74\x61\x63t\163";break;case "\0658": $related_module = "Ca\155\160\141igns";break;case "59": $related_module = "P\162\157\144\x75\143\x74s";break;case "\x373": $related_module = "\x41\143\143\157\x75n\164\x73";break;case "\x37\065": $related_module = "\x56\145\x6ed\157\162\x73";break;case "8\061": $related_module = "\x56\145nd\157\162s";break;case "\x37\x36": $related_module = "Pot\145\156\164i\x61\154\163";break;case "7\070": $related_module = "\x51\165o\x74\x65\x73";break;case "\x38\x30": $related_module = "\123\x61le\x73\x4f\162d\x65r";break;case "\066\x38":case "1\060": $related_module = getSalesEntityType($fk_record);break;}if ($related_module != "") {$tabid = getTabId($related_module);$temp = &VTCacheUtils::$$field_inf;unset($temp[$tabid]);$focus2 = CRMEntity::getInstance($related_module);if ($fk_record != "" && $fk_record != "\x30") {$result_delete = $this->db->query("\x53E\x4cECT d\x65le\x74\x65\x64 FROM\x20\x76t\x69\147e\x72\137c\162\155\x65nt\151ty\040\127\x48\x45\122\105\x20\x63r\155id='" . $fk_record . "'\040\101\x4eD\x20\x64e\x6c\145\164\145\x64\075\060");if ($this->db->num_rows($result_delete) > 0) {$focus2->retrieve_entity_info($fk_record, $related_module);$focus2->id = $fk_record;}}$this->replacements["$" . "R\x5f" . $x27($related_module) . "_C\122M\x49D\044"] = $focus2->id;$this->replacements["$" . "R_" . $x27($columnname) . "\137\103\122\x4d\x49D\044"] = $focus2->id;if ($$vcv == '5.2.1') {$displayValueCreated = getDisplayDate($focus2->column_fields['createdtime']);$displayValueModified = getDisplayDate($focus2->column_fields['modifiedtime']);} else {$createdtime = new DateTimeField($focus2->column_fields['createdtime']);$displayValueCreated = $createdtime->getDisplayDateTimeValue();$modifiedtime = new DateTimeField($focus2->column_fields['modifiedtime']);$displayValueModified = $modifiedtime->getDisplayDateTimeValue();}$this->replacements["\x24" . "R_" . $x27($related_module) . "\x5fCR\105A\x54E\104TI\x4d\105\137DA\124\105T\x49\x4d\x45\x24"] = $displayValueCreated;$this->replacements["\x24" . "\122\137" . $x27($columnname) . "_\103\122\x45\x41TE\104\124\111\115\x45\137D\x41\124\x45\x54I\x4d\x45\044"] = $displayValueCreated;$this->replacements["$" . "\x52\137" . $x27($related_module) . "\x5fM\117\104\111FIED\x54\x49\115\105\137\x44A\124\105T\x49\115E\x24"] = $displayValueModified;$this->replacements["\044" . "R\137" . $x27($columnname) . "\x5fM\117\104\x49\x46\111ED\x54\111ME\x5f\104\101T\x45\x54IM\x45$"] = $displayValueModified; if (isset($related_module)) {$entityImg = "";switch ($related_module) {case "\x43on\164a\x63ts":$entityImg = $this->x1b($focus2->id);break;case "\120\162o\x64u\x63\x74s":$entityImg = $this->x1d($focus2->id);break;}$this->replacements['$R_' . $x27($related_module) . '_IMAGENAME$'] = $entityImg;$this->replacements['$R_' . $x27($columnname) . '_IMAGENAME$'] = $entityImg;}if (isset($tacModules[$related_module])) {$tacSql = "S\105\114E\x43T \x74\145\170\164\040F\122O\115\x20\x76\164\x69\x67\x65\x72\137\164\x61\1434\x79o\165\x5ft\x65x\x74\163\040WHER\105\x20id\075\x3f";$tacResult = $this->db->pquery($tacSql, array($focus2->id));$tacText = $this->db->query_result($tacResult, 0, "t\x65xt");$tacText = $x15($tacText, ENT_QUOTES, $this->def_charset);$this->replacements["$" . "\x52\x5f" . $x27($related_module) . "\137\x54AC\064YO\125\044"] = $tacText;$this->replacements["\x24" . "R\x5f" . $x27($columnname) . "\137T\x41\103\x34\131\x4f\125\x24"] = $tacText;}if (isset($descModules[$related_module])) {$descSql = "\123\105\114E\x43\x54\x20\x74ex\164\x20\106\122\x4f\115\x20\166t\151\x67\x65r\x5fd\145\x73\x63\162\x69\x70\x74io\x6es4\x79\x6fu_t\x65\170t\x73 \x57\x48E\122E\x20\151\144=\x3f";$descResult = $this->db->pquery($descSql, array($focus2->id));$descText = $this->db->query_result($descResult, 0, "tex\164");$descText = $x15($descText, ENT_QUOTES, $this->def_charset);$this->replacements["\x24" . "R_" . $x27($related_module) . "_\104\105S\103\x34\x59\117\125\044"] = $descText;$this->replacements["\044" . "R\137" . $x27($columnname) . "\x5f\104\105\123\x43\064YO\125\044"] = $descText;}if (isset($ModCommentsModules[$related_module])) {$modCommText = $this->x32($focus2->id);$modCommText = $x15($modCommText, ENT_QUOTES, $this->def_charset);$this->replacements["\x24" . "\x52\137" . $x27($columnname) . "_M\x4f\x44\103\117\x4dM\105N\124\x53\x24"] = $modCommText;} $this->x15();$this->x10($related_module, $focus2, true);$this->x10($related_module, $focus2, $columnname); $this->x34($related_module, $focus2, $columnname);unset($focus2);} if ($row["u\151ty\160\x65"] == "6\x38") {$fieldModRel[$row["\x66\151el\x64\151d"]][] = "\x43o\156ta\143\x74s";$fieldModRel[$row["\x66\x69\x65\154\144id"]][] = "\x41\x63\143\157un\x74\163";}if (isset($fieldModRel[$row["\146i\145\154d\151\x64"]])) {foreach ($fieldModRel[$row["\146\x69\x65l\x64\x69d"]] as $idx => $relMod) { if ($relMod == $related_module)continue;$tmpTabId = getTabId($relMod);$temp = &VTCacheUtils::$$field_inf;unset($temp[$tmpTabId]);$tmpFocus = CRMEntity::getInstance($relMod);$this->replacements["$" . "R_" . $x27($relMod) . "\137\x43R\115ID\x24"] = $tmpFocus->id;$this->replacements["\x24" . "\122_" . $x27($columnname) . "\137\103\122MID\x24"] = $tmpFocus->id;if ($$vcv == '5.2.1') {$displayValueCreated = getDisplayDate($tmpFocus->column_fields['createdtime']);$displayValueModified = getDisplayDate($tmpFocus->column_fields['modifiedtime']);} else {$createdtime = new DateTimeField($tmpFocus->column_fields['createdtime']);$displayValueCreated = $createdtime->getDisplayDateTimeValue();$modifiedtime = new DateTimeField($tmpFocus->column_fields['modifiedtime']);$displayValueModified = $modifiedtime->getDisplayDateTimeValue();}$this->replacements["\x24" . "\x52_" . $x27($relMod) . "_\x43R\x45\101\x54E\x44TI\x4d\x45\x5f\104A\124\105\124I\x4d\105$"] = $displayValueCreated;$this->replacements["$" . "\x52\137" . $x27($columnname) . "\137\x43R\105\x41\x54\105D\124\111\115E\x5f\104\x41T\105\x54I\115\105\x24"] = $displayValueCreated;$this->replacements["$" . "\x52\137" . $x27($relMod) . "\137M\x4f\x44\111\x46\111\105\104\x54\x49\115E\137D\x41\x54ETIM\x45\044"] = $displayValueModified;$this->replacements["\044" . "\122\137" . $x27($columnname) . "\137\115\x4fD\111\x46I\105D\x54\x49\x4d\105\137DA\124\x45\x54\111M\x45\x24"] = $displayValueModified;$this->x10($relMod, $tmpFocus, true);$this->x10($relMod, $tmpFocus, $columnname); $this->x34($relMod, $tmpFocus, $columnname);unset($tmpFocus);}}}}}private function x0c() { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; require_once("\143\x6c\141\163\163e\x73/\163\151mple\137\x68\x74\155\154\137d\x6f\155.\160\150p");$html = str_get_html($this->content);$tableDOM = false;foreach ($html->find("\x74\x64") as $td) {if ($x2c($td->plaintext) == "\043P\x52O\x44\x55\103\x54\102\x4c\x4f\103\x5fST\x41\122\124\043") { $td->parent->outertext = "\043PR\117\104\x55CTB\114\x4f\103\x5f\123\124\x41R\124\043"; $oParent = $td->parent;while ($oParent->tag != "t\141b\154\x65")$oParent = $oParent->parent; list($tag) = $x12(">", $oParent->outertext, 2); $header = $oParent->first_child();if ($header->tag != "tr")$header = $header->children(0);if ($x1b($td->parent->prev_sibling()->children[0])) {$header_style = $td->parent->prev_sibling()->children[0]->getAttribute("s\x74\171\154\x65");} else {$header_style = '';}$footer_tag = "<\164\x72\x3e";if (isset($header_style)) {$StyleHeader = $x12("\073", $header_style); if (isset($StyleHeader)) {foreach ($StyleHeader as $style_header_tag) {if ($x28($style_header_tag, "\x62\x6f\x72\144\145\x72\x2dto\160") == TRUE) {$footer_tag.="\074\164\x64\040\x63ol\163\160an\x3d'" . $td->getAttribute("\x63o\x6c\163\160a\156") . "'\040\163t\171\154\145='" . $style_header_tag . "'\x3e&n\142s\160;\074\x2ftd>";}}}} else {$footer_tag.="\x3c\x74d\040\x63ol\x73\160\141n\075'" . $td->getAttribute("c\x6f\154\x73\160\x61\156") . "'\x20\163tyl\x65\075'bo\162\144\145\x72\055\x74o\160\072\061p\170\040\163\x6f\154id \x23\x30\x30\x30\060\060\x30\x3b'>&\156\x62s\160;\074\x2f\x74\144\x3e";}$footer_tag.="\x3c\x2f\164\x72\x3e"; $var = $td->parent->next_sibling()->last_child()->plaintext;$subtotal_tr = ""; if ($x28($var, "T\x4fT\101L") !== false) { if ($x1b($td)) {$style_subtotal = $td->getAttribute("\x73\164\x79\154\145");}if (isset($td->innertext)) {list($style_subtotal_tag, $style_subtotal_endtag) = $x12("\x23\120\x52\117D\x55\x43\x54\102\x4cOC\137\x53\x54\x41\122\124\x23", $td->innertext);} else {$style_subtotal_tag = "";$style_subtotal_endtag = "";} if (isset($style_subtotal)) {$StyleSubtotal = $x12("\x3b", $style_subtotal);if (isset($StyleSubtotal)) {foreach ($StyleSubtotal as $style_tag) {if ($x28($style_tag, "\x62or\144\x65r\x2dt\x6f\160") == TRUE) {$tag.="\040\163\x74\x79\x6ce\x3d'" . $style_tag . "'";break;}}}} else {$style_subtotal = "";}$subtotal_tr = "<\164\x72\x3e";$subtotal_tr.="\074td\x20col\x73\160an='" . ($td->getAttribute("\x63\157\154\x73\x70an") - 1) . "'\x20\x73\x74y\154\x65\075'" . $style_subtotal . "\x3bbo\x72\144\145\x72-r\151\147h\164\072\x6eo\156\x65'\076" . $style_subtotal_tag . "%\107\137\x53\x75bt\x6f\164al\045" . $style_subtotal_endtag . "\074\057\x74\x64>";$subtotal_tr.="\074\x74d\x20\x61\x6c\151\147\x6e='\162i\147h\x74'\040\156\x6fw\162\x61p='\x6e\157wr\141p'\x20\163\x74\171\154\145\x3d'" . $style_subtotal . "'>" . $style_subtotal_tag . "" . $x21($var, "$") . "\137\x53\x55\102\124O\124AL$" . $style_subtotal_endtag . "\074\x2f\x74\144\x3e";$subtotal_tr.="\x3c/\164\x72\076";}$tag.="\076";$tableDOM["\164a\147"] = $tag;$tableDOM["\150\145\x61\144er"] = $header->outertext;$tableDOM["\x66\157\157\x74\x65\162"] = $footer_tag;$tableDOM["s\x75b\164ot\x61\x6c"] = $subtotal_tr;}if ($x2c($td->plaintext) == "\043\120\x52\x4fD\125\103\124\x42\114\117\x43\x5f\x45\116\x44\x23")$td->parent->outertext = "\043\x50\x52\117\x44\x55\103\x54B\114\117\x43\137\x45\116D\x23";}$this->content = $html->save();return $tableDOM;}private function x0d() { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $query = "\x73\145\154ect\x20\x2a\040\146\162\x6f\155\x20v\164i\147\145\x72\137\x69\156\x76\145\x6e\x74\157ry\x70\x72\x6f\144\x75\143\164\162\145\x6c wh\145\x72\x65\040\151d\x3d\x3f";$result = $this->db->pquery($query, array($this->focus->id));$num_rows = $this->db->num_rows($result);if ($num_rows > 0) { $Products = $this->x34($this->module, $this->focus); $var_array = array();if ($x28($this->content, "\043\x50R\117\104U\x43T\x42\x4c\x4fC\137S\124\x41\x52T#") !== false && $x28($this->content, "#\x50\x52\x4f\x44\125\103\x54\102\x4c\117C\137E\116D#") !== false) {$tableTag = $this->x0c();$breaklines_array = $this->x19();$breaklines = $breaklines_array["\160r\157\144\165c\164\x73"];$show_header = $breaklines_array["\x73\x68\x6fw_h\x65\x61\x64\145\162"];$show_subtotal = $breaklines_array["\x73h\x6f\x77_\163\x75\142\x74\157\x74a\x6c"];$breakline_type = "";if ($x10($breaklines) > 0) {if ($tableTag !== false) {$breakline_type = "\x3c/\164a\142le>" . $this->pagebreak . $tableTag["\164\141\147"];if ($show_header == 1)$breakline_type.=$tableTag["h\x65a\144\145\162"];if ($show_subtotal == 1) {$breakline_type = $tableTag["s\x75\142\164\x6f\164a\154"] . $breakline_type;} else {$breakline_type = $tableTag["\146\157o\x74e\x72"] . $breakline_type;}} else {$breakline_type = $this->pagebreak;}}$ExplodedPdf = array();$Exploded = $x12("#PR\x4fDU\x43\x54BL\x4f\103_S\x54AR\124\x23", $this->content);$ExplodedPdf[] = $Exploded[0];for ($iterator = 1; $iterator < $x10($Exploded); $iterator++) {$SubExploded = $x12("\x23\x50\x52\x4f\104\x55\103T\102L\117C\137\105\x4e\104#", $Exploded[$iterator]);foreach ($SubExploded as $part)$ExplodedPdf[] = $part;$highestpartid = $iterator * 2 - 1;$ProductParts[$highestpartid] = $ExplodedPdf[$highestpartid];$ExplodedPdf[$highestpartid] = '';}if ($Products["\x50"]) {foreach ($Products["\x50"] as $Product_Details) {foreach ($ProductParts as $productpartid => $productparttext) {$breakline = "";if ($breakline_type != "" && isset($breaklines[$Product_Details["\123ER\126\111C\105S\137\122\105C\x4f\x52\x44_\111\104"] . "_" . $Product_Details["\120\x52\x4f\x44\x55\x43\124\123\x45\121\125\105\116\x43\105"]]) || isset($breaklines[$Product_Details["\x50RODUC\124\123_RE\103\x4f\x52\104\x5f\x49\x44"] . "\137" . $Product_Details["\x50\x52O\104U\x43T\123\105QUEN\x43\105"]])) {$breakline = $breakline_type;}$productparttext.=$breakline;foreach ($Product_Details AS $coll => $value) {$productparttext = $x23("$" . $x27($coll) . "$", $value, $productparttext);}$ExplodedPdf[$productpartid].=$productparttext;}}}$this->content = $x18('', $ExplodedPdf);}}}private function x0e() { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $html = str_get_html($this->content);$toSkip = 0;foreach ($html->find("ro\167\x62\162\x65\x61k") as $pb) {if ($pb->outertext == $this->rowbreak) {$tmpPb = $pb;while ($tmpPb != null && $tmpPb->tag != "t\144") {$tmpPb = $tmpPb->parent();}if ($tmpPb->tag == "td") { if ($toSkip > 0) {$toSkip--;continue;} $prev_sibling = $tmpPb->prev_sibling();$prev_sibling_styles = array();while ($prev_sibling != null) {$prev_sibling_styles[] = $this->x0f($prev_sibling);$prev_sibling = $prev_sibling->prev_sibling();} $next_sibling = $tmpPb->next_sibling();$next_sibling_styles = array();while ($next_sibling != null) {$next_sibling_styles[] = $this->x0f($next_sibling);$next_sibling = $next_sibling->next_sibling();}$partsArr = $x12($this->rowbreak, $tmpPb->innertext);for ($i = 0; $i < ($x10($partsArr) - 1); $i++) {$tmpPb->innertext = $partsArr[$i];$addition = '<tr>';for ($j = 0; $j < $x10($prev_sibling_styles); $j++) {$addition.='<td ' . $prev_sibling_styles[$j] . '>&nbsp;</td>';}$addition.='<td style="' . $tmpPb->getAttribute("\163t\x79\154\x65") . '">' . $partsArr[$i + 1] . '</td>';for ($j = 0; $j < $x10($next_sibling_styles); $j++) {$addition.='<td ' . $next_sibling_styles[$j] . '>&nbsp;</td>';}$addition .= '</tr>';$tmpPb->parent()->outertext = $tmpPb->parent()->outertext . $addition;} $toSkip = $x10($partsArr) - 2;}}}$this->content = $html->save();}private function x0f($elm) { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $atts_string = "";if ($elm != null) {foreach ($elm->attr as $attName => $attVal) {$atts_string .= $attName . '="' . $attVal . '" ';}}return $atts_string;}private function x10($emodule, $efocus, $is_related = false, $inventory_currency = false) { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $cur_usr = "\x63u\x72r\x65\x6e\x74\x5fu\x73e\x72";global $$cur_usr;$related_fieldnames = array("re\154ated_\x74o","r\x65l\x61\164ed\x74o","\x70\x61\162e\x6e\x74\x5f\151\144","p\141\x72\x65\156\x74\x69\144","\160\x72odu\143t\x5fid","\x70\x72o\144\165\143\164\151\144","ser\166i\x63\145\x5f\151\144","s\x65rvicei\144","\x76e\156\x64or_\x69\144","pr\x6f\144\165\143\164","\x61\143\143\x6f\x75\156\x74","in\166\157i\x63eid","l\151\156\x6b\x74\x6f\x61c\x63\157\x75nt\163\143\x6f\156t\x61cts","\160\x72\157\152\x65\x63\164i\144","sc\x5f\x72\145\x6c\141t\145d\x5f\x74\x6f");if ($inventory_currency !== false)$inventory_content = array();$tabid = getTabid($emodule);$convEntity = $emodule;if ($is_related === false) {$related = "";} else {$related = "\122\x5f";if ($is_related !== true)$convEntity = $is_related; }$Checkboxes = array();$Picklists = array();$Textareas = array();$Datefields = array();$Multipicklists = array();$CurrencyFields = array();$NumberFields = array();if ($tabid == '9') {$sql = "\x53\x45\114E\103\x54\x20\x66i\145\x6cd\x6e\x61\x6d\x65\x2c\040uit\171\160\145\x20\x46\x52\x4f\x4d\040v\164i\x67\145r_f\151\x65ld W\110E\122\105 tabi\x64\x20I\x4e (\071,1\x36)";} else {$sql = "\x53E\x4c\105CT \x66ie\154dn\x61m\x65\054\x20uity\160e \106R\x4f\115 \x76\x74i\x67\145r_\146i\145\154\x64\x20\127HER\x45\040tab\x69\x64\x20\075\x20'" . $tabid . "'";}$result = $this->db->query($sql);while ($row = $this->db->fetchByAssoc($result)) {switch ($row['uitype']) {case '19':case '20':case '21':case '24':$Textareas[] = $row["\146\x69\145\154\x64\156\141me"];break;case '5':case '6':case '23':case '70':$Datefields[] = $row["\146i\x65\x6cd\x6e\141\x6d\145"];break;case '15':$Picklists[] = $row["\x66\x69\145\x6c\144nam\x65"];break;case '56':$Checkboxes[] = $row["fi\145\x6c\x64\156\x61m\145"];break;case '33':$Multipicklists[] = $row["\146i\145l\x64nam\x65"];break;case '71':$CurrencyFields[] = $row["\146\x69\x65\x6c\144\x6e\x61\x6d\145"];break;case '9':$NumberFields[] = $row["f\151\145\x6c\x64\x6eam\145"];break;}if ($row['fieldname'] == 'salutationtype')$Picklists[] = $row["f\x69\x65l\144na\x6d\145"];}foreach ($efocus->column_fields as $fieldname => $value) {if ($fieldname == "\141\x73\x73i\147n\x65d_u\x73e\x72_\151\x64")$value = $this->x1e($value);elseif ($fieldname == "\x61c\143o\165n\x74\x5fid") { $value = getAccountName($value);} elseif ($fieldname == "\160\157te\156\x74\151\x61\x6c\137\151\x64")$value = getPotentialName($value);elseif ($fieldname == "\143\157\x6e\x74ac\164\137id")$value = getContactName($value);elseif ($fieldname == "\x71\165ot\x65\137\x69\144")$value = getQuoteName($value);elseif ($fieldname == "\x73\141l\145\163\157\162de\162\137\x69d")$value = getSoName($value);elseif ($fieldname == "c\x61\155\x70\x61ig\156\x69\144")$value = getCampaignName($value);elseif ($fieldname == "\x74\x65rms_\x63\157n\144\151\x74i\157\x6es")$value = $this->x25($value);elseif ($fieldname == "comm\145\156\164s")$value = $this->x26($efocus);elseif ($fieldname == "f\x6f\x6c\144\145\x72\151\x64")$value = $this->x27($value);elseif ($fieldname == "\x74\x69me_\x73\164ar\164" || $fieldname == "\164i\155\x65_\145\156\144") {$curr_time = DateTimeField::convertToUserTimeZone($value);$value = $curr_time->format('H:i');} elseif ($x19($fieldname, $related_fieldnames)) {if ($value != "") {$parent_module = getSalesEntityType($value);$displayValueArray = getEntityName($parent_module, $value);if (!empty($displayValueArray)) {foreach ($displayValueArray as $p_value) {$value = $p_value;}}if ($fieldname == "\151nvo\151\143\145i\x64" && $value == "0")$value = "";}}if ($x19($fieldname, $Datefields)) {if ($emodule == "E\166en\x74s" || $emodule == "C\x61l\x65\x6e\x64\141\x72") {if ($fieldname == "\x64\141\164\145\x5f\x73t\141\162t" && $efocus->column_fields["\x74\151\155\145\x5fs\x74\x61\x72\x74"] != "") {$curr_time = $efocus->column_fields['time_start'];$value = $value . ' ' . $curr_time;} elseif ($fieldname == "\144u\145\137\144\141t\145" && $efocus->column_fields["ti\x6d\145_e\156\x64"] != "") {$curr_time = $efocus->column_fields['time_end'];$value = $value . ' ' . $curr_time;}}if ($value != "")$value = getValidDisplayDate($value);}elseif ($x19($fieldname, $Picklists)) {if (!$x19($x2c($value), $this->ignored_picklist_values)) {$value = $this->x20($value, $emodule);} else {$value = "";}} elseif ($x19($fieldname, $Checkboxes)) {$pdf_app_strings = return_application_language($this->language);if ($value == 1) {$value = $pdf_app_strings["\x79\145\163"];} else {$value = $pdf_app_strings["n\x6f"];}} elseif ($x19($fieldname, $Textareas)) {$value = $x1d($value);$value = $x15($value, ENT_QUOTES, $this->def_charset);} elseif ($x19($fieldname, $Multipicklists))$value = $x24(' |##| ', ', ', $value);elseif ($x19($fieldname, $CurrencyFields)) {if ($x1a($value)) {if ($inventory_currency === false) {$user_currency_data = getCurrencySymbolandCRate($$cur_usr->currency_id);$crate = $user_currency_data["\162\141t\145"];} else {$crate = $inventory_currency["\143\x6f\156v\145\162s\151on\137\x72ate"];}$value = convertFromMasterCurrency($value, $crate);}$value = $this->x23($value);} elseif ($x19($fieldname, $NumberFields)) {$value = $this->x23($value);}if ($inventory_currency !== false) {$inventory_content[$x27($emodule . "\x5f" . $fieldname)] = $value;} else {$this->replacements["\x24" . $related . $x27($convEntity . "_" . $fieldname) . "\x24"] = $value;}}if ($inventory_currency !== false) {return $inventory_content;} else {$this->x15();}}private function x11() { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $cur_usr = "c\x75\162\162\145\x6e\164_u\x73\145\162";$root_dir = "\162\x6fo\x74\137\x64\x69\x72e\x63tor\171";global $$cur_usr, $$root_dir; $sql = "\123EL\105\x43\124\040* F\x52\117M \x76t\x69\147e\x72\x5f\157r\x67\141niz\x61\x74ionde\x74\x61\151\x6c\x73";$result = $this->db->query($sql);$Org_Details = $this->db->fetchByAssoc($result, 1);foreach ($Org_Details AS $coll => $value) {if ($coll == "logo")$value = '<img src="' . $$root_dir . 'test/logo/' . $Org_Details["l\157\x67\x6f\x6e\141\155\145"] . '">';$this->replacements["$" . $this->org_cols[$coll] . "$"] = $value;} $sql = "S\x45\114\105CT\040tan\144\143 \106\122OM \x76\x74\151\x67\x65\x72_\151\x6ev\x65\156\164\157\x72y\x5f\x74a\x6ed\x63 \x57HE\122\105\x20\x74\171\x70\x65\x20=\040'In\166\x65nt\x6f\x72\x79'";$tandc = $this->db->query_result($this->db->query($sql), 0, "\x74\141n\x64\x63");$this->replacements["\x24" . "T\105\x52\115S\137\101\x4e\x44\137\103\117\x4eD\111\124I\117\116\123\044"] = $x1d($tandc); $user_sql = "S\105\x4c\x45C\x54 *
 \040\040 \x20\040 \x20\040\040\x20 \x20\040\x20 \040\x20\040\x46\x52\x4f\x4d \x76\x74\151\147\x65\x72\x5f\165s\145rs\x20W\x48ER\x45 \x69\x64\075" . $this->focus->column_fields["\141\163s\x69g\156\145d\x5f\165\x73e\x72_\151d"];$user_res = $this->db->query($user_sql);$user_row = $this->db->fetchByAssoc($user_res);$this->replacements["\044" . "\x55\x53\x45\122_\x43\x52\115\111\x44$"] = $user_row["id"];$this->replacements["$" . "\125\123E\122\137US\105RN\x41M\x45$"] = $user_row["u\163\x65\162\137\156\x61\x6d\145"];$this->replacements["\x24" . "U\x53\x45\x52\137\106\111\x52\x53T\x4eA\x4d\105\044"] = $user_row["\146i\x72s\164\137\x6ea\155\x65"];$this->replacements["\x24" . "\125\123ER\137L\x41\123\x54N\x41M\x45\044"] = $user_row["\154\141st_name"];$this->replacements["\x24" . "\x55S\105\122\137\105\115A\x49\x4c\x24"] = $user_row["e\155\x61il\x31"];$this->replacements["\044" . "\x55S\105\122\x5f\124\111T\x4cE$"] = $user_row["t\x69tl\x65"];$this->replacements["$" . "\125SE\122\x5fFA\x58$"] = $user_row["\160h\x6fne\137\x66\x61\170"];$this->replacements["\x24" . "U\123\x45\122\x5f\104\x45\x50\101\122\124ME\x4e\x54\044"] = $user_row["\144\x65p\141\x72tme\156t"];$this->replacements["\x24" . "\125\123\105\x52\x5fOTH\x45R\137\x45MA\111\x4c$"] = $user_row["\145m\x61\x69\x6c\062"];$this->replacements["\x24" . "\x55\123ER\x5fP\x48O\x4e\105\x24"] = $user_row["p\x68\157\x6e\x65_\x77\x6f\x72\x6b"];$this->replacements["\044" . "\125\x53E\122\x5f\x59\x41H\117\117\x49\x44\044"] = $user_row["\x79a\150\x6fo\x5f\151d"];$this->replacements["\x24" . "\x55\x53\x45\x52_\115\x4fBI\x4c\105$"] = $user_row["pho\x6e\x65_\155\157\142\151\154\145"];$this->replacements["\044" . "\125SER_\x48\x4f\x4dE\x5fP\x48\x4fN\105\x24"] = $user_row["p\x68on\145\x5fho\x6d\145"];$this->replacements["$" . "\x55\x53\105\122\x5fO\x54H\105\122\x5f\120HO\116\105\044"] = $user_row["\x70hone\x5f\x6fth\x65\162"];$this->replacements["\044" . "\125\x53\105R\137\x53I\107H\116\x41\x54\125\122\x45\044"] = $user_row["si\x67n\141\x74\x75\162\145"];$this->replacements["\x24" . "\x55\x53ER\x5f\116\117\x54E\x53$"] = $user_row["d\145\163\x63r\151\x70\164io\156"];$this->replacements["\x24" . "\x55\123\105R\137\x41\104\x44\x52\x45S\x53\044"] = $user_row["\x61d\x64\x72\x65\x73\x73_\163\164\x72eet"];$this->replacements["\044" . "U\123E\122\x5fC\117UNT\122Y\044"] = $user_row["a\x64\x64\x72e\x73\x73_\143\x6f\x75\x6etr\171"];$this->replacements["\x24" . "U\x53\105R\x5f\103\111T\131\x24"] = $user_row["\x61\x64d\x72\145ss\x5fc\151\164\171"];$this->replacements["\044" . "\x55S\105\122\137Z\111\120$"] = $user_row["\x61\144d\x72es\x73\x5f\x70\x6f\163\x74a\x6c\143o\144\145"];$this->replacements["\x24" . "\x55\123\105\122\137S\124\101T\105\x24"] = $user_row["\141\144\144r\x65s\x73_\x73\164\141t\x65"]; $this->replacements["$" . "L\137\x55\x53\x45R\x5fCRM\111D\x24"] = $$cur_usr->id;$this->replacements["$" . "L\x5f\x55S\x45R_\x55\x53\105\122N\101\115E\044"] = $$cur_usr->column_fields["\165s\x65\162\x5f\x6e\x61\155\x65"];$this->replacements["\x24" . "\114\137\x55\x53\x45\x52\x5fF\x49RS\x54NAME\x24"] = $$cur_usr->column_fields["\x66i\162\163t_\156\141m\145"];$this->replacements["$" . "\114\x5fU\x53E\x52\x5f\114\101S\x54NA\115\x45\044"] = $$cur_usr->column_fields["l\x61\163\164_n\141m\145"];$this->replacements["$" . "\114\137U\123ER\137\x45\115\x41\111L$"] = $$cur_usr->column_fields["\x65\x6d\x61\151l\061"];$this->replacements["\x24" . "\x4c\137\x55SER\137\x54\x49\x54\x4cE$"] = $$cur_usr->column_fields["\x74it\154\x65"];$this->replacements["\x24" . "\x4c_US\105\122\x5f\x46A\130\x24"] = $$cur_usr->column_fields["\160\x68\157\156\145_\x66\141\170"];$this->replacements["\044" . "\x4c\x5f\125\123\105\x52_\104\x45P\x41R\124ME\x4eT$"] = $$cur_usr->column_fields["d\x65\x70a\x72\x74m\145\156\x74"];$this->replacements["$" . "L\x5f\125S\105R_O\x54\x48E\x52\x5f\105\115\x41\111L\044"] = $$cur_usr->column_fields["e\155\x61\151\154\062"];$this->replacements["\044" . "\114_U\123\x45\x52_P\x48ON\x45\x24"] = $$cur_usr->column_fields["\160\150\x6f\156e\137\x77\x6f\162\153"];$this->replacements["$" . "L\137\x55S\105R\137\x59A\110OO\111\x44$"] = $$cur_usr->column_fields["y\141\150\157\x6f\137i\144"];$this->replacements["\x24" . "\x4c_U\123\x45R_\115\x4f\x42\x49\x4c\x45\044"] = $$cur_usr->column_fields["\160\150o\156e_\155\157bile"];$this->replacements["\x24" . "\x4c\137\125S\x45R\137HO\x4d\105\x5f\x50\110\117\x4e\x45\044"] = $$cur_usr->column_fields["pho\156\x65_\x68ome"];$this->replacements["\x24" . "L_\x55\123\x45\x52_\x4f\124\110\x45R_\120H\117\116E$"] = $$cur_usr->column_fields["p\150\157\156\145\x5fo\x74\x68e\162"];$this->replacements["\044" . "\114\137\125SE\x52_\x53\x49\107H\116\x41\124\125\x52\105$"] = $$cur_usr->column_fields["\163\x69\x67\x6e\x61t\x75\162\145"];$this->replacements["$" . "\x4c\x5f\x55SE\122\x5f\116\117\124\x45\123\044"] = $$cur_usr->column_fields["\x64e\x73\x63\x72\151pt\x69\157n"];$this->replacements["$" . "\114\x5f\x55\x53\x45\122_AD\x44R\x45\x53\x53\x24"] = $$cur_usr->column_fields["a\144\144r\x65s\163\x5f\x73\x74r\x65\145\x74"];$this->replacements["\044" . "L\x5f\x55SER\137\103OU\x4eT\122\131\x24"] = $$cur_usr->column_fields["a\144d\162\x65s\x73_cou\156\164\x72y"];$this->replacements["\044" . "\114\137\125\123E\122_\103\x49T\x59$"] = $$cur_usr->column_fields["\x61d\x64\x72\x65s\x73_c\151t\x79"];$this->replacements["$" . "\114\x5f\x55\x53\x45\122\x5f\132\x49\x50\044"] = $$cur_usr->column_fields["a\x64d\x72e\x73\x73\137\160os\164al\143\x6f\x64e"];$this->replacements["\044" . "\114\x5f\x55S\105\122\137S\x54\101\x54\105\044"] = $$cur_usr->column_fields["a\x64\144res\x73\x5f\x73\164\x61\164\145"];$this->x15(); $focus_user = CRMEntity::getInstance("Us\145\162s");$focus_user->id = $this->focus->column_fields["\x61\163si\x67\156\145\144\137\165s\145\162\137i\144"];$this->x24($focus_user, $focus_user->id, "U\163\145\x72s");$this->x10("\125\x73\145\x72\163", $focus_user, false); $curr_user_focus = CRMEntity::getInstance("\125\163e\x72s");$curr_user_focus->id = $$cur_usr->id;$this->x24($curr_user_focus, $curr_user_focus->id, "\x55\x73\145\x72\x73");$this->x10("\x55\x73e\x72s", $curr_user_focus, true); $this->replacements["\044" . "\125\x53\105\122\123_\103RM\111D\044"] = $focus_user->id;$this->replacements["$" . "\x52\x5f\125SE\122\123_\103\x52M\111\x44\x24"] = $curr_user_focus->id;$this->x15();}private function x12() { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; require_once "\155odu\154e\x73\057PDF\115a\x6b\x65r\057\120D\x46\x4dak\145\162\x2e\x70h\160";$PDFMaker = new PDFMaker();$app_lang = return_application_language($this->language);$mod_lang = return_specified_module_language($this->language, $this->module);list($custom_lang, $languages) = $PDFMaker->GetCustomLabels();$currLangId = "";foreach ($languages as $langId => $langVal) {if ($langVal["p\x72\145\146\151\x78"] == $this->language) {$currLangId = $langId;break;}} if ($x28($this->content, "\045\x47\x5f") !== false) {foreach ($app_lang as $key => $value) {$this->replacements["%\107\137" . $key . "\x25"] = $value;}} if ($x28($this->content, "%\115\137") !== false) {foreach ($mod_lang as $key => $value) {$this->replacements["%\x4d\x5f" . $key . "\x25"] = $value;}} if ($x28($this->content, "\x25C_") !== false) {foreach ($custom_lang as $key => $value) {$this->replacements["\045" . $value->GetKey() . "\045"] = $value->GetLangValue($currLangId);}} if ($x10($this->relBlockModules) > 0) {$services_lang = return_specified_module_language($this->language, "Ser\x76\151ce\163");$contacts_lang = return_specified_module_language($this->language, "C\157\x6e\164\141\x63t\x73");foreach ($this->relBlockModules as $relBlockModule) {if ($relBlockModule != "") {$relMod_lang = return_specified_module_language($this->language, $relBlockModule);$en_us_app_lang = return_application_language("\x65\156\x5fu\x73"); $this->replacements["\045R\x5f" . $x27($relBlockModule) . "\x5f\x53e\x72vice\x20\116\x61m\x65\x25"] = $services_lang["\123\145\x72v\x69\x63e N\141\155e"];$this->replacements["\045\122\137" . $x27($relBlockModule) . "_\123\x65c\x6f\156\x64\x61\x72\171\x20\105\x6da\151\154%"] = $contacts_lang["\x53\x65c\x6f\156\144\141ry\040E\x6d\x61\x69l"];$this->replacements["\x25\122\137" . $x27($relBlockModule) . "_L\141\163t\040\115o\x64\x69\146\x69\145\x64 \x42\171\x25"] = $app_lang["\114as\x74 \x4d\157\x64\151\x66i\145\x64"];$this->replacements["%\122\137" . $x27($relBlockModule) . "\x5fCo\156\166\x65r\x73\151\157\156 \122\141te\045"] = $app_lang["LB\114\x5f\x43\x4fN\126\x45\122\123I\117\x4e\x5fR\x41\x54\105"];$this->replacements["\045R\x5f" . $x27($relBlockModule) . "\x5fL\151st \x50r\x69\143e%"] = $app_lang["LB\114\x5fL\x49S\x54\x5f\120\x52\111\x43E"];$this->replacements["\045\x52_" . $x27($relBlockModule) . "\137\x44\x69\x73\x63o\165n\164\045"] = $app_lang["\x4c\x42\114\137\104\111\123\103O\125\x4e\x54"];$this->replacements["\x25\122\x5f" . $x27($relBlockModule) . "\137\121\165a\156\164\x69\x74\x79%"] = $app_lang["L\x42\114\x5f\121\x55A\116\124\111\x54Y"];$this->replacements["%\x52_" . $x27($relBlockModule) . "\x5f\x43\157\155\155\145\156t\163\045"] = $app_lang["\114\x42\x4c_\103\117M\115E\116\124S"];$this->replacements["\x25\122\x5f" . $x27($relBlockModule) . "_Cur\x72\x65\x6e\x63\171\x25"] = $app_lang["L\x42\114_C\125\122\122\105NC\131"];$this->replacements["\045\x52_" . $x27($relBlockModule) . "\137\x44\165\145\x20D\141\164e\x25"] = $app_lang["LBL\x5f\x44\125\x45_\104A\x54\105"];$this->replacements["%\122\x5f" . $x27($relBlockModule) . "\137\105\156\x64 \124i\x6de\045"] = $app_lang["\x45\x6ed\x20Tim\145"];$this->replacements["%R\x5f" . $x27($relBlockModule) . "\137\122\145\154\x61\164\145d\040\164o%"] = $app_lang["\x4c\102L_\x52E\114\x41\124\105D_\x54\117"];$this->replacements["\x25R\x5f" . $x27($relBlockModule) . "\x5fA\x73\163\151\147ne\x64 \x54\x6f\045"] = $app_lang["\x41s\163i\x67n\145\x64 T\x6f"];$this->replacements["\x25\x52_" . $x27($relBlockModule) . "\x5f\x43\x72\145\141\x74\145\144 Tim\x65\045"] = $app_lang["C\162\145\x61\x74\145\x64\x20\x54\x69\x6d\x65"];$this->replacements["%\122\x5f" . $x27($relBlockModule) . "\137\115\x6f\x64\x69\x66\151\145\144\x20\124\x69\155\x65%"] = $app_lang["\115\x6f\x64\151\146\x69e\144 T\x69\155\x65"];foreach ($relMod_lang as $key => $value) {$this->replacements["%R\137" . $x27($relBlockModule) . "_" . $x16($key, ENT_QUOTES, $this->def_charset) . "\045"] = $value;}}}}$this->x15();}private function x13() { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; require_once("\143las\163\145\x73\057si\x6d\160\x6c\x65\137\150\x74\x6d\154\x5fd\x6f\x6d\x2e\160hp");$this->replacements["\133BA\x52\103\117D\x45\x7c"] = "\x3cb\x61rco\x64\x65\x3e";$this->replacements["\174\x42\x41RC\x4f\104\x45\x5d"] = "\074\x2f\142\141\162\x63o\x64\145>";$this->x15();$html = str_get_html($this->content);foreach ($html->find("b\x61r\143\x6f\144e") as $barcode) {$params = $x12("|", $barcode->plaintext);list($type, $code) = $x12("\075", $params[0], 2);$barcodeAtts = 'code="' . $code . '" type="' . $type . '" ';for ($i = 1; $i < $x10($params); $i++) {list($attName, $attVal) = $x12("\075", $params[$i], 2);$barcodeAtts .= $x29($attName) . '="' . $attVal . '" ';}$barcode->outertext = '<barcode ' . $barcodeAtts . '/>';}$this->content = $html->save();}private function x14() { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $salt = "s\151\x74\x65\137\x55RL";global $$salt;$surl = $$salt;require_once("\143\154\x61\x73\x73e\x73/s\x69mpl\x65\x5fh\x74\x6d\154_\x64o\x6d.\x70\150\x70");$html = str_get_html($this->content);foreach ($html->find("\151\x6d\x67") as $img) {if ($surl[$x25($surl) - 1] != "\x2f")$surl = $surl . "\057";if ($x28($img->src, $surl) === 0) {$newPath = $x23($surl, "", $img->src);if ($x13($newPath))$img->src = $newPath;}}$this->content = $html->save();}private function x15() { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; if (!empty($this->replacements)) {$this->content = $x23($x0b($this->replacements), $this->replacements, $this->content);$this->replacements = array();}} private function x16() { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $salt = "s\151t\145_\125RL";global $$salt;$this->site_url = $x2c($$salt, "\057");$sql = "\123\105LE\103\124 \x76\x74\151\x67\x65r_pd\x66\x6da\153\x65\x72\056\x2a\054\040v\x74i\147\x65\x72_pd\146\x6d\141\153e\162_\x73\x65\164t\151\156\x67\x73\x2e\x2a
\012 \040\x20 \040\x20\x20\x20\x20\x20\040\040\040 \x46\x52\117\x4d\040\x76t\151ge\162\137p\x64\x66\x6d\x61\x6b\145\162\x0d\012\x20\040\x20\040 \x20\x20 \x20 \040\x20\x20 \x4cE\106T\040J\x4f\x49\x4e\x20\x76ti\147e\162\x5f\x70\x64\146m\x61\x6b\x65\x72\137\x73\145t\164\151\x6egs\015\012\040 \x20\040 \x20     \x20\040 \x20 \117\x4e\040\x76t\151\x67\145\x72_\160\x64\x66\155a\x6b\x65\162\x5f\x73et\164\x69\156g\x73\x2ete\x6dp\154a\x74\145\x69\x64\040= \166\164\151ge\x72_pdfmak\x65\x72.t\x65\155\x70l\x61\164\145i\144\015\012\x20\x20 \040\040 \040  \040 \040\040\040W\x48\105R\x45\040\x76t\151\x67\x65\162\x5f\x70\x64\146\x6da\153\x65\162\x2et\x65\155\160l\x61\164\145i\144\x3d\077";$result = $this->db->pquery($sql, array($this->templateid));$data = $this->db->fetch_array($result);$this->decimal_point = $x15($data["\x64\145ci\x6dal\x5f\160\x6f\151\156\x74"], ENT_QUOTES);$this->thousands_separator = $x15(($data["th\157u\x73an\x64\163\137\x73epar\x61t\x6f\x72"] != "\163\160" ? $data["\164h\157\165\x73a\x6e\144\163\x5f\163\145\160\x61\x72\141\164o\162"] : " "), ENT_QUOTES);$this->decimals = $data["\144e\x63im\x61\x6c\163"];$this->header = $data["h\145\141\144\145r"];$this->footer = $data["\x66\x6f\x6ft\x65\162"];$this->body = $data["\x62\x6f\x64\x79"];$this->filename = $data["f\x69\x6c\145_\x6e\x61m\145"];$this->templatename = $data["\146il\145\156\x61m\x65"]; $formatPB = $data["\x66\157\162\x6d\x61\x74"];if ($x28($formatPB, ";") > 0) {$tmpArr = $x12(";", $formatPB);$formatPB = $tmpArr[0] . "\x6d\155\040" . $tmpArr[1] . "\155\155";} elseif ($data["\x6frie\156\164\x61\x74\151o\156"] == "\154\x61\156dsc\x61\x70\145") {$formatPB .= "\x2d\114";}$this->pagebreak = '<pagebreak sheet-size="' . $formatPB . '" orientation="' . $data["\157\162i\x65\156\x74\141\164\x69o\x6e"] . '" margin-left="' . ($data["\155a\162g\151\156\x5flef\164"] * 10) . 'mm" margin-right="' . ($data["\155\x61\x72\x67\151\x6e\x5f\x72\151g\150\164"] * 10) . 'mm" margin-top="0mm" margin-bottom="0mm" margin-header="' . ($data["\x6d\x61\x72\147i\x6e\137\x74op"] * 10) . 'mm" margin-footer="' . ($data["\x6d\x61\x72\147in\137b\x6f\x74\x74\x6f\x6d"] * 10) . 'mm" />'; }private function x17() { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $sql = "\x53\105\x4c\105\103T\040v\x61\154\x75\145\x20FR\117M\040vt\x69\147e\x72\x5f\160\144\x66\155\x61\153\x65\162\137i\x67\156\x6f\x72\x65pi\143k\x6c\151\x73t\166\141l\x75es";$result = $this->db->query($sql);while ($row = $this->db->fetchByAssoc($result)) {$this->ignored_picklist_values[] = $row["\166al\x75e"];}}private function x18($module, $focus) { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $taxtype = $this->x22($module, $focus);$query = "\163e\x6cec\164\040\x63\x61se w\x68\x65\x6e \166t\151\x67er_\160\x72\x6f\144u\143\164\x73\056\x70\162\x6f\144\x75c\x74\x69\144\x20\041=\040''\040\164\x68\x65\x6e \x76t\151\x67\145\x72\137\x70r\157\144\165\x63\164\x73\x2epr\x6f\x64\x75\143t\156\141\155\x65\040\145\154\x73e\040\166\164\151\x67\x65\162\137\x73\145r\166\x69\x63\145\x2e\x73e\162\x76\151\143\145\156\x61\x6d\145\040\145nd \x61s\040\x70\162\157\x64\165\x63\x74\156a\155e\054" ."\x20\143a\163\145\x20\167\x68\x65\x6e\x20vt\x69ge\x72\x5f\x70r\x6f\144\x75ct\x73.pro\144\x75\x63ti\144\040\041= ''\x20t\150e\x6e\x20\x76t\151\x67\x65r\137p\162o\144u\x63\x74\x73\x2e\x70\162\157d\x75\143\164i\x64 \145\x6cs\x65 \166\164\151g\x65r\x5f\x73e\162\x76\x69\x63\145.\x73\x65r\x76\151\143\x65\151\x64\040\145n\144\040a\163 \160si\144," ." \x63a\x73e\040w\x68\x65n\x20v\164\151\147\x65\162_\x70\x72\157d\165\143t\x73\056\x70\162oducti\144\040!\x3d\x20''\x20th\x65\x6e \x76\x74\151\147\145\x72_\160\162\157\x64\165\143\164s\056p\x72o\144\165c\x74\x5f\x6e\157\040\145\154\x73\x65\040v\164\151g\145r\x5fs\145\x72vi\143\145\x2e\163\145r\x76\151\x63e_\x6e\x6f\040\145n\x64\040\141\163 psn\x6f," ."\x20\143\141\163e\x20\167\x68\x65n \166tig\x65\162_\x70\162\x6fd\165\143ts.\x70\162odu\143\x74\151d !\075\040''\x20\x74\150e\x6e\x20'P\162\157d\165\143\x74s'\x20el\x73\x65\x20'S\145\x72v\x69\x63\x65\x73'\x20\145\156d \141s e\x6e\x74\x69t\x79\164\171\160\145," ." c\141s\145\x20\x77h\x65\x6e \x76\164\x69ge\x72_\160\162od\x75\x63t\163\x2e\160r\157\144\165\x63t\x69\x64\x20\041\x3d\040''\x20\164\150\145n\x20\x76\x74i\147\145\162\137\160\x72\157d\x75\x63ts\x2e\165n\151\164_\160\162\x69\143e\040e\154\x73\x65\x20\x76\x74i\x67\x65r_\x73e\x72\166\x69\143\x65.u\x6e\151\x74\137\x70\x72\x69\x63e \145\156\x64\x20as\x20\165\x6e\x69t\x5f\160\x72\151\x63\145\054" ." \143\141\163e\040wh\x65\156 \166\164\x69\x67\145r_p\162\157\144\165\x63\164s.p\x72\x6fd\x75\x63ti\x64\x20\041=\040'' th\145n\040\x76\164\x69\x67\145\x72\x5f\160\x72o\144uc\x74s\x2e\165\163a\x67\x65\165\x6e\x69\x74\040e\x6c\163\145\040\x76t\151\147\145\162\x5fs\x65\162\166\151\x63e.\x73\145r\x76i\x63e\x5f\x75sag\145un\x69\x74\x20\x65\156\x64\x20\141s\x20\x75\163\x61\x67\145\165\x6eit\054" ."\040case\040\x77\x68\x65\156 \166\164ig\145\162\137pro\144\x75\x63t\163\056\x70ro\x64\x75\143\x74id\040\041= ''\x20t\150\x65\156\040v\164iger_p\162o\144u\143\x74\x73\056\x71\164\x79\137p\145\162_\x75\x6e\151\164\x20\x65lse\040v\x74i\x67e\162\137\x73\x65\162\166\151\143e\056\161\x74y\137p\145\162_\165\x6ei\164\x20\x65\156\144 \141s\040\161ty\x5f\160er\137\165n\x69t\x2c" ." \143a\163\145\040\x77\150\x65\x6e\x20vti\x67\x65\162\137\160\162odu\x63ts\x2e\x70\x72\157du\x63tid\040\041\x3d ''\x20t\x68\145\156\x20\x76\164\151\x67\145\162\137prod\165c\164\x73\056\x71\x74\171i\x6e\163to\143\153 \145l\x73\145\040'N\101' \x65\x6e\x64\040as\x20\161\164\171\x69\156\163\x74\157c\x6b," ."\x20\143\x61se\x20\167\x68e\156\x20\x76t\151\x67e\162_\160\162od\165\x63\164s.\160\162odu\143ti\x64\040\x21=\x20''\040th\x65n\x20\x63\x31\056\x64\145\163c\162ip\164\x69\157n \145\154\x73e\x20\x632\x2e\144\145s\143\162\151p\x74i\x6fn\x20en\144\x20\141\163 \x70\x73\144\145\x73\143\x72\x69\160t\x69o\x6e\x2c\x20\x76t\x69ger\x5fin\166\145\156t\157r\171p\x72o\144\x75\143tr\x65\x6c\x2e*\040" ."\040\146r\157\x6d\040\x76t\151g\x65r\x5fi\x6e\x76entor\x79\160\162\x6fd\x75ct\162e\154" ."\x20\x6c\x65\x66t \x6aoi\156\040\166ti\x67\x65\x72\x5fp\x72o\x64u\143\164s\x20\157\156\040\x76\x74\x69\x67e\162_pr\157\x64uct\163.p\162odu\x63ti\144=v\x74\151\x67\x65\162_\151\x6e\166\145\x6e\164o\162\x79\160\162o\144u\x63t\x72\145\x6c\x2e\160r\157du\143\x74\x69\x64 " ."\x20\154\x65ft \x6ao\151n \166t\151\x67e\x72\x5fc\162\x6de\156t\151\164\x79\x20\x61\163\x20c\x31\x20\157\156\x20\143\061\x2e\x63\x72\155\151d\x20= \166\164\x69\147er\x5f\x70\x72odu\x63\x74s.\160r\x6f\144\x75\x63\x74\151\144\x20" ."\040\x6ce\x66t\040\152\157\x69\x6e\x20v\x74\151\x67\x65\x72\137\x73e\162\x76\151\x63\145\040\x6f\156\x20\166\164\x69ge\162\x5f\x73e\162\166\151\x63e\056s\x65\162\x76\x69\143e\x69\x64\x3d\x76\x74i\x67\145\162\137\x69n\166\145n\x74\x6f\x72\x79p\162\157du\x63\164\x72\145\154\x2e\160\162\x6fd\x75\x63\164\x69\144 " ."\x20\154\x65\146t\x20j\157\x69\156\x20\x76\x74\151\147e\x72_c\162\x6d\145\156\x74it\171 \141\x73\040\143\x32\x20o\x6e \x63\062\x2e\x63\162m\x69\x64\040\x3d\x20\166\x74\151g\x65\162_s\x65r\x76i\x63\x65.\163\x65\x72\166\151\x63\x65\151\144\x20" ." \x77\150\145re id\075? \x4f\122\104ER\x20B\x59 \163\145\161\165\145\156\x63\145_\x6e\157";$result = $this->db->pquery($query, array($focus->id));$num_rows = $this->db->num_rows($result);$netTotal = "0\x2e\x30\x30"; $totalAfterDiscount_subtotal = 0;$total_subtotal = 0;$totalsum_subtotal = 0; list($images, $bacImgs) = $this->x1a($focus->id); $mpdfSubtotalAble = array();$Total_Tax_Values = array();for ($i = 1; $i <= $num_rows; $i++) {$sub_prod_query = $this->db->pquery("SEL\105\103\124\x20p\x72\x6f\144\x75c\164\x69d\040f\x72om\x20\166t\151\x67\145\162_i\156\x76ent\157\162\171\x73\x75\142\160\x72\157d\165c\x74\162\x65\x6c \127\x48\105\122\x45 id\x3d?\040A\x4eD\040seq\x75e\x6e\143\145\137\156\x6f\075\077", array($focus->id, $i));$subprodname_str = '';if ($this->db->num_rows($sub_prod_query) > 0) {for ($j = 0; $j < $this->db->num_rows($sub_prod_query); $j++) {$sprod_id = $this->db->query_result($sub_prod_query, $j, "\x70\x72\157\144u\143t\151\144");$sprod_name = getProductName($sprod_id);$str_sep = "";if ($j > 0)$str_sep = "\072";$subprodname_str .= $str_sep . "\x20\x2d\x20" . $sprod_name;}}$subprodname_str = $x23("\072", "\x3cbr>", $subprodname_str);$psid = $this->db->query_result($result, $i - 1, "\x70s\151d");$psno = $this->db->query_result($result, $i - 1, "\x70\x73no");$productid = $this->db->query_result($result, $i - 1, "\x70ro\144\165c\164\x69\x64");$entitytype = $this->db->query_result($result, $i - 1, "\145n\x74\151\x74\171\164\x79\160\x65");$producttitle = $productname = $this->db->query_result($result, $i - 1, "pr\x6f\x64\165ctn\x61m\145");if ($subprodname_str != "")$productname .= "<\142\x72\x2f\076\074sp\141n \163\164\x79l\x65='\143\157l\157\162\072\x23\103\060\103\x30C0\073fon\x74\x2d\163\164\171le\x3a\151\164al\151\x63\073'>" . $subprodname_str . "\074\x2f\163\x70\141n\076";$comment = $this->db->query_result($result, $i - 1, "com\x6de\156\164");$psdescription = $this->db->query_result($result, $i - 1, "p\163d\145\163c\x72\x69pt\x69\157\156");$inventory_prodrel_desc = $this->db->query_result($result, $i - 1, "\144\x65\x73\x63\x72\x69\160t\x69\x6f\x6e");$qtyinstock = $this->db->query_result($result, $i - 1, "\x71ty\151\156\x73\x74\x6f\143k");$qty = $this->db->query_result($result, $i - 1, "q\x75\141\x6e\164i\164\x79");$qty_per_unit = $this->db->query_result($result, $i - 1, "q\164y_\x70\x65r_\165ni\164");$usageunit = $this->db->query_result($result, $i - 1, "\x75s\x61\x67e\165ni\164");$unitprice = $this->db->query_result($result, $i - 1, "u\156\151\x74_\160\162\x69\143\145");$listprice = $this->db->query_result($result, $i - 1, "\x6c\x69\x73\164\x70r\151ce");$total = $qty * $listprice; $discount_percent = $this->db->query_result($result, $i - 1, "di\x73\143o\165nt\137\x70\x65r\x63\145nt");$discount_amount = $this->db->query_result($result, $i - 1, "\x64\x69\x73co\x75\x6et\x5fa\x6d\x6f\x75\x6e\x74");$totalAfterDiscount = $total;$productDiscount = "\060.\0600";$productDiscountPercent = "";if ($discount_percent != "\116U\x4c\x4c" && $discount_percent != "") {$productDiscount = $total * $discount_percent / 100;$totalAfterDiscount = $total - $productDiscount; $productDiscountPercent = $discount_percent;} elseif ($discount_amount != "N\125\x4cL" && $discount_amount != "") {$productDiscount = $discount_amount;$totalAfterDiscount = $total - $productDiscount;} $netprice = $totalAfterDiscount; if ($taxtype == "\x69nd\x69\x76i\x64\165\x61\154") {$taxtotal = "\060\x2e\x30\060";$tax_info_message = $mod_strings["\114\102\x4c\137TO\x54\101\114_\x41\106\124\x45\122\x5f\x44I\x53\103\117UN\x54"] . "\040\x3d\x20$totalAfterDiscount \\\156";$tax_details = getTaxDetailsForProduct($productid, "all");$Tax_Values = array();for ($tax_count = 0; $tax_count < $x10($tax_details); $tax_count++) {$tax_name = $tax_details[$tax_count]["\164\141\170\156\141m\145"];$tax_label = $tax_details[$tax_count]["\164\x61\x78lab\145l"];$tax_value = getInventoryProductTaxValue($focus->id, $productid, $tax_name);$individual_taxamount = $totalAfterDiscount * $tax_value / 100;$taxtotal = $taxtotal + $individual_taxamount;if ($tax_name != "" && $tax_value > 0) {$vatblock[$tax_name . "-" . $tax_value]["\x6c\141\x62\x65\154"] = $tax_label;$vatblock[$tax_name . "\055" . $tax_value]["\x6ee\x74\164\x6f"] += $totalAfterDiscount;$vatblock[$tax_name . "\x2d" . $tax_value]["\166at"] += $x20($individual_taxamount, $this->decimals);$vatblock[$tax_name . "-" . $tax_value]["\x76\141\x6cue"] = $tax_value;$x0c($Tax_Values, $tax_value);$x0c($Total_Tax_Values, $tax_value);}}$netprice = $netprice + $taxtotal; if ($x10($Tax_Values) > 0) {$tax_avg_value = $x0e($Tax_Values);} else {$tax_avg_value = "\x30\0560\x30";}$Details["\x50"][$i]["P\x52\117\x44\125C\x54\x56AT\x50\105R\x43E\x4e\124"] = $this->x23($tax_avg_value);$Details["\120"][$i]["\x50\122\x4f\x44\125\103\x54\126\x41\124\x53\125\115"] = $this->x23($taxtotal);}if ($entitytype == "\x50r\157\144\165\143t\163") {$Details["\120"][$i]["PR\117D\x55C\124\x53\137\103R\x4d\x49D"] = $psid;$Details["\120"][$i]["\x53E\x52\126\x49\103\105\x53_\x43\x52M\111\104"] = "";} else {$Details["P"][$i]["P\x52\117\x44\125\x43\124S\x5fCRM\x49\x44"] = "";$Details["\x50"][$i]["\x53E\122V\111CES\x5f\x43\122M\x49\x44"] = $psid;}$Details["\x50"][$i]["\120\x53\x5f\103\x52MI\104"] = $psid;$Details["P"][$i]["P\123\137\x4e\117"] = $psno;if ($comment != "") {$comment = $x23("\\\x6e", "<b\162\076", $x1d($comment));$comment = $x15($comment, ENT_QUOTES, $this->def_charset);$productname .= "\x3c\x62\x72 \x2f>\074s\155\x61\154\x6c\x3e" . $comment . "\x3c/\163mall\x3e";}$Details["\x50"][$i]["\120\122O\104UC\x54\116\101\115E"] = $productname;$Details["\120"][$i]["\120R\x4f\x44\x55C\x54T\111\124\114\105"] = $producttitle;$psdescription = $x23("\\n", "\074\142r\076", $x1d($psdescription));$Details["\x50"][$i]["\120R\x4f\x44\125C\124DE\x53\x43R\x49PTI\x4f\116"] = $x15($psdescription, ENT_QUOTES, $this->def_charset);$Details["\120"][$i]["\x50\x52O\104\125\103\x54\x45D\111\124\104\x45\123\103\x52I\120\x54\x49\117N"] = $comment;$inventory_prodrel_desc = $x23("\\\x6e", "<\142r>", $x1d($inventory_prodrel_desc));$Details["\x50"][$i]["\x43\122\115N\x4fW\120\122\x4f\104\x55\x43T\x44E\123\103\x52\111\120\x54I\117N"] = $x15($inventory_prodrel_desc, ENT_QUOTES, $this->def_charset);$Details["\x50"][$i]["\120\x52O\104\x55C\x54\x4cI\x53\124\120\122I\103\x45"] = $this->x23($listprice);$Details["\120"][$i]["P\122\x4fD\x55\103\x54\x54\117\x54A\x4c"] = $this->x23($total);$Details["P"][$i]["PR\x4fDU\x43\x54\x51UA\x4e\124I\x54\131"] = $this->x23($qty);$Details["\x50"][$i]["\120\x52\x4f\x44\x55\103TQ\x49\116\x53\124\117\x43K"] = $this->x23($qtyinstock); $Details["\x50"][$i]["PR\117\x44\125\103TP\x52\x49\103E"] = $this->x23($unitprice); $Details["P"][$i]["\x50\x52\x4f\x44U\103T\x50O\123I\124\x49\x4f\x4e"] = $i;$Details["\120"][$i]["\120RO\x44\125\x43TQ\x54Y\x50\x45RU\116\x49T"] = $this->x23($qty_per_unit); $value = $usageunit;if (!$x19($x2c($value), $this->ignored_picklist_values)) {$value = $this->x20($value, "\x50r\157\x64u\143ts\057\123\145\x72\x76\x69\143\145\163");} else {$value = "";}$Details["P"][$i]["P\122\117DU\x43\x54\125\x53\101\x47E\x55\116\x49\x54"] = $value;$Details["\x50"][$i]["\x50\122\117\104\125\x43TD\111\123\x43\117U\x4eT"] = $this->x23($productDiscount);$Details["\120"][$i]["\x50\122O\104U\103\124\104\111\x53\x43\x4f\x55\x4e\x54\120\x45\x52\103\105N\x54"] = $this->x23($productDiscountPercent);$Details["\120"][$i]["\x50\x52ODU\103T\123TOT\x41\x4c\101\x46\124ER\104\111\x53\103O\125\116\x54\123\125M"] = $totalAfterDiscount; $Details["P"][$i]["P\x52\117\104UC\124\123\x54\x4f\x54A\114\x41FTERD\x49\123C\117\125\116\124"] = $this->x23($totalAfterDiscount);$Details["\120"][$i]["\120\x52\x4f\x44\125\103\124\x54OT\x41L\x53\x55\x4d"] = $this->x23($totalAfterDiscount + $taxtotal); $totalAfterDiscount_subtotal += $totalAfterDiscount;$total_subtotal += $total;$totalsum_subtotal+= $totalAfterDiscount + $taxtotal;$Details["P"][$i]["\x50\122\x4fDU\x43T\x53\x54\117T\x41\114\x41FTE\122DIS\x43\117\x55\116T_\x53\x55BTO\x54A\114"] = $this->x23($totalAfterDiscount_subtotal);$Details["P"][$i]["\x50\122\x4f\104\x55\103\124\x54O\124\x41\x4c\137\x53U\102\x54\117\124\x41\x4c"] = $this->x23($total_subtotal);$Details["P"][$i]["\x50\122\x4f\104\x55\103TT\x4f\124\x41\114S\x55M\x5f\123\125B\124\x4fT\x41L"] = $this->x23($totalsum_subtotal); $mpdfSubtotalAble[$i]["\x24" . "\124\x4f\x54A\114\101\106\124\x45RD\111S\103OUN\x54\137S\x55\102\x54\117T\101\114\044"] = $Details["P"][$i]["\x50R\117D\125\x43TS\124\117\124\101\x4cAF\124E\122D\111\123\103\x4fU\x4e\124\x5f\123\125\102\124O\x54\101\x4c"];$mpdfSubtotalAble[$i]["\044" . "\x54\117TA\114\137SU\x42\x54\117\x54\101\x4c\x24"] = $Details["\x50"][$i]["\x50\x52O\104\x55\x43T\124\117\124A\x4c\137\123UBTO\124\101\114"];$mpdfSubtotalAble[$i]["$" . "\124\117\124\x41L\x53\x55M_S\125B\x54O\124\101\x4c\x24"] = $Details["\x50"][$i]["P\122\117D\x55\103T\124\117T\101\114\x53\125\115\x5f\123U\102T\x4f\124\x41L"]; $sequence = $this->db->query_result($result, $i - 1, "\163eq\165\x65\x6e\x63\145\x5fn\157");$Details["\x50"][$i]["\120RO\104\x55\x43\124S\x45QUE\116C\105"] = $sequence;if (isset($images[$productid . "\137" . $sequence])) {$width = "";$height = "";if ($images[$productid . "\137" . $sequence]["\167\x69\x64\164\150"] > 0)$width = " \x77\151\144\x74\x68\x3d'" . $images[$productid . "\x5f" . $sequence]["\167\x69\x64\x74\x68"] . "'\040";if ($images[$productid . "\137" . $sequence]["\150e\x69\x67\150\164"] > 0)$height = " \x68\x65\151\x67h\164\x3d'" . $images[$productid . "\137" . $sequence]["\x68\x65ight"] . "'\040";$Details["\x50"][$i]["\x50\x52\117DUC\x54S\x5f\x49\x4d\101G\x45\x4e\x41\115\105"] = "\x3c\x69\x6d\x67 \163\x72\143\x3d'" . $this->site_url . "\x2f" . $images[$productid . "\137" . $sequence]["s\162c"] . "'\040" . $width . $height . "\x2f\x3e";}elseif (isset($bacImgs[$productid . "\x5f" . $sequence])) {$Details["P"][$i]["\x50R\117\x44U\x43T\x53\137\111\x4d\x41\x47\x45\116\101M\x45"] = "\x3cim\x67\x20\163\162\x63='" . $this->site_url . "/" . $bacImgs[$productid . "\137" . $sequence]["\163r\143"] . "'\x20w\151\x64\x74\150\075'\070\x33' \057>";} $focus_p = CRMEntity::getInstance("\120\162\x6f\144u\143ts");if ($entitytype == "\120r\157d\x75cts" && $psid != "") {$focus_p->id = $psid;$this->x24($focus_p, $psid, "P\162\x6f\144\165\x63\x74\163"); }$currencytype = $this->x21($module, $focus);$Array_P = $this->x10("\x50\x72o\x64\x75\143t\x73", $focus_p, false, $currencytype);$Details["P"][$i] = $x0d($Array_P, $Details["P"][$i]);unset($focus_p);$focus_s = CRMEntity::getInstance("\x53e\162v\x69\x63e\x73");if ($entitytype == "S\x65\162\166i\143\x65s" && $psid != "") {$focus_s->id = $psid;$this->x24($focus_s, $psid, "S\x65\162v\x69\x63\x65\163"); }$Array_S = $this->x10("\x53\x65\x72\x76i\x63\x65\163", $focus_s, false, $currencytype);$Details["P"][$i] = $x0d($Array_S, $Details["P"][$i]);unset($focus_s); $sumwithoutvat += $totalAfterDiscount;$netTotal = $netTotal + $netprice;} if ($this->module == $module)$this->bridge2mpdf["\x73\165\x62t\x6f\164al\x73\x41\x72r\141y"] = $mpdfSubtotalAble; $finalDiscount = "0\x2e00";$final_discount_info = "\060";$finalDiscountPercent = ""; if ($focus->column_fields["\150\144\x6e\104i\x73co\165\x6e\x74\120e\x72ce\156\164"] != "\060") {$finalDiscount = ($netTotal * $focus->column_fields["\150\x64nDi\163\143\157\165\x6e\164\120\x65\162ce\156\x74"] / 100);$finalDiscountPercent = $focus->column_fields["\x68\144nD\151s\143\157\x75n\x74\x50er\x63\x65nt"];} elseif ($focus->column_fields["h\144n\104is\x63o\x75\156t\101\x6d\x6fu\x6et"] != "0") {$finalDiscount = $focus->column_fields["hd\156\104\x69\163c\x6fu\x6et\101\x6do\x75n\x74"];} $taxtotal = "\x30\056\0600";if ($taxtype == "\x67roup") {$final_totalAfterDiscount = $netTotal - $finalDiscount;$tax_details = getAllTaxes("av\141il\x61\142\x6c\145", "", "e\144it", $focus->id);for ($tax_count = 0; $tax_count < $x10($tax_details); $tax_count++) {$tax_name = $tax_details[$tax_count]["\x74\x61\170na\x6de"];$tax_label = $tax_details[$tax_count]["\164\x61\170labe\154"];$tax_value = $this->db->query_result($result, 0, $tax_name);if ($tax_value == "" || $tax_value == "N\125\114L")$tax_value = "0.0\x30";$taxamount = ($netTotal - $finalDiscount) * $tax_value / 100;$taxtotal = $taxtotal + $taxamount;if ($tax_name != "" && $tax_value > 0) {$vatblock[$tax_name]["\154\x61be\154"] = $tax_label;$vatblock[$tax_name]["n\145\x74t\157"] = $final_totalAfterDiscount;$vatblock[$tax_name]["\x76\x61\164"] += $taxamount;$vatblock[$tax_name]["\x76al\165\x65"] = $tax_value; } $total_vat_percent += $tax_value;}$vat_value = $taxtotal; foreach ($Details["\120"] as $keyP => $valueP) {$productvatsum = ($Details["\120"][$keyP]["\120\122\x4f\x44U\x43\x54S\124O\x54A\114A\x46\124\105\122\104\x49\123\103\x4f\x55\116T\x53\125\115"] * $total_vat_percent) / 100;$producttotalsum = $Details["P"][$keyP]["\x50\x52\117\104\125C\124ST\117TA\x4cA\x46\x54E\122D\x49S\103O\125N\124SU\115"] + $productvatsum;$Details["P"][$keyP]["\120\x52\117D\x55\103TV\101\x54\x50E\122C\105N\x54"] = $this->x23($total_vat_percent);$Details["P"][$keyP]["P\122O\104\x55\103\124\126\101\x54\123\125\x4d"] = $this->x23($productvatsum);$Details["\x50"][$keyP]["\x50\122O\x44U\103T\124\x4f\124AL\x53\x55\115"] = $this->x23($producttotalsum);} } else {if ($x10($vatblock) > 0) {foreach ($vatblock as $keyM => $valueM)$vat_value += $valueM["v\x61\x74"];} else {$vat_value = "\x30\x2e\060\x30";}} $shAmount = ($focus->column_fields["\150\144n\123_H\x5f\101m\157\x75\x6e\164"] != "") ? $focus->column_fields["h\x64n\123\x5fH\x5f\x41mou\156t"] : "\060.\060\x30";$shtaxtotal = "\060.0\x30";$shtax_details = getAllTaxes("\x61\166\x61ilabl\145", "\x73\x68", "\145d\151\164", $focus->id);for ($shtax_count = 0; $shtax_count < $x10($shtax_details); $shtax_count++) {$shtax_name = $shtax_details[$shtax_count]["\164a\170\x6e\141\x6d\145"];$shtax_label = $shtax_details[$shtax_count]["\164\141\x78\154a\142el"];$shtax_percent = getInventorySHTaxPercent($focus->id, $shtax_name);$shtaxamount = $shAmount * $shtax_percent / 100;$shtaxtotal = $shtaxtotal + $shtaxamount;}$totalafterdiscount = $sumwithoutvat - $finalDiscount;$totalwithvat = ($sumwithoutvat - $finalDiscount) + $vat_value;$Details["\124O\x54\x41\114"]["\116\105\x54\124\x4f\x54\x41\114"] = $this->x23($netTotal);$Details["TO\124\x41\x4c"]["T\117T\x41\x4c\x57I\x54\110OUT\126A\x54"] = $this->x23($sumwithoutvat);$Details["\x54O\124\101\x4c"]["F\x49NA\114\104I\123\103\117\x55\116\124"] = $this->x23($finalDiscount);$Details["T\x4f\124\x41L"]["\x46\x49\x4eA\x4cDI\x53\103\117UN\124\120\105R\x43\105\x4e\x54"] = $this->x23($finalDiscountPercent);$Details["T\x4fT\101L"]["\x54\117T\x41LA\106\124\105R\x44I\x53C\117\x55\116T"] = $this->x23($totalafterdiscount);$Details["\x54OTA\x4c"]["\x54A\130\x54\117\x54\x41L"] = $this->x23($vat_value);$Details["\x54\117\x54\101\x4c"]["TA\x58\124OT\101\114P\105R\x43\x45\116T"] = $this->x23($total_vat_percent); $Details["\x54O\x54\x41L"]["\x54OT\101\114\127I\x54HVAT"] = $this->x23($totalwithvat);$Details["\124\x4fT\x41\114"]["\123\110\x54\x41XA\115\x4f\125NT"] = $this->x23($shAmount);$Details["\124\x4f\x54\101\114"]["\x53\110\x54\101\130TO\124\101\x4c"] = $this->x23($shtaxtotal);$Details["T\117\124\x41\114"]["\126AT\102\114\117\x43K"] = $vatblock;return $Details;}private function x19() { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $sql = "\123\105L\x45\x43T\040\x70\x72\x6fdu\x63\164\151\x64\x2c \163\145\x71\165\145\156c\145\054\040s\x68\157\x77\137\150e\x61\144\145\x72\054 s\x68o\x77\x5f\x73ub\x74\157\164a\154\x20\106\122\117M\040\166\164i\147e\162\137\x70\144\x66ma\x6b\x65r_b\x72\145\141k\x6c\x69\x6ee\x20\x57H\105\x52E \x63r\x6di\144\x3d\077";$res = $this->db->pquery($sql, array($this->focus->id));$products = array();$show_header = 0;$show_subtotal = 0;while ($row = $this->db->fetchByAssoc($res)) {$products[$row["\x70\x72o\144\165\x63\164\x69\x64"] . "_" . $row["\163\x65qu\x65n\143\x65"]] = $row["\x73equ\145n\x63\145"];$show_header = $row["\163\150\x6f\167\137h\x65\141\144\145r"];$show_subtotal = $row["\163h\157\167_\163u\x62\x74o\x74a\x6c"];}$output["\x70r\x6f\144uc\164s"] = $products;$output["\163\150o\x77\137\x68\x65\x61d\145r"] = $show_header;$output["sh\x6fw\x5f\163\165\142\x74ot\x61\x6c"] = $show_subtotal;return $output;}private function x1a($id, $isProductModule = false) { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; if ($isProductModule === false) {$sql = "\123\x45LE\103\x54 \166\164i\x67\145r_i\156\x76\145ntor\171\160r\x6f\144\165\143t\162\x65\x6c.\x70\x72\157duct\151\144\054\040\x76\x74\151g\x65\162_i\x6e\x76\x65nt\x6f\162\x79\160r\157d\x75\143tre\154.\163\x65\161u\145\156\143e\137n\x6f,\040v\164\151g\x65r\x5fa\164\164\141\143\150\x6d\145n\x74\163\x2e\x61tt\x61\x63\150m\x65\x6e\x74sid\x2c\040\x6e\141\155\145\x2c \160\141\x74\x68\015\x0a		\x20\040\x20\040\040\040\x20\x20\x20\x20F\122\117\115\040\x76\164\151\x67e\x72_\x69\x6e\166\145\156to\x72yp\x72od\x75\x63tr\145\x6c
\012\011\x09\040\x20\040 \040\040\x20 \040\040LE\106\x54 J\117\111\x4e vt\151\147\x65\x72_\x73\x65\141\164\x74\x61\x63\150m\145\156\164s\x72\145\154
\012\x09	\x20\x20\x20\x20\x20 \x20\x20\x20\040 \x20\117\x4e\x20\166\x74\x69\x67\x65r\x5f\163e\x61\x74\164\141\x63hm\145\156tsr\145\154\x2e\143rm\x69\x64\075\166\164i\147\145r\137\151\156\x76e\x6et\157\x72\171\160\162\x6fduc\164\162\145l\056\x70\162o\x64\165\143\164\151d\x0d\x0a\011	 \040 \x20\x20\040\040\x20 \x20\x4c\x45\x46T \112\117\111\x4e \166\164i\x67\145r_\141\x74tac\150\x6de\156t\x73\015\012\011\011 \x20\x20\x20\040 \040\040\040\040\040\x20O\x4e\040\166\x74\x69\147\x65\162_\x61\164t\141\x63h\x6d\x65\156\x74\x73.\x61\164t\x61c\150\155\145nts\151\x64\075\x76\x74i\147\x65\162_\163\145att\x61\x63h\x6d\x65n\x74\163r\x65\x6c.at\164\141ch\155en\x74si\x64\x0d\x0a	\x09\x09	\x20 \x49\116\x4eER\040\x4a\x4fI\x4e\x20\x76\x74\151ge\x72\x5f\x63r\155\145\156ti\164\171\015\x0a	\x09\011\x09\x20   \x4f\116\x20\x76\164\x69g\x65\162_\141\x74\164achm\145\156\164\163\056\141\164\164\x61c\x68\x6den\164\x73\x69\x64\x3d\166\164\x69\147\x65\162_\x63\162\x6den\x74i\x74\x79\056c\162mid\x0d
	\011\040 \040\040 \040\040\x20\040\x20\x57\x48\105RE\040vt\x69\147\145\162_\143rm\x65\x6et\151\164\171\x2e\144\145l\x65\x74ed\075\060\040\101\116\x44\040\x76\164\x69\147er\137in\x76\x65nt\x6fr\171\160\162\x6fd\165\x63\164\162\x65\x6c.\151d\075\077\x0d\x0a\011\x09\x09\x09 \040\117R\x44\x45R\040\102Y v\x74\x69g\x65r\137\151\x6e\x76\145\156\x74o\162ypr\157\x64\x75\x63\x74re\x6c.se\161u\145\x6ec\145_\156\157";} else {$sql = "S\105\x4cECT \166\x74i\x67\x65r_prod\x75\143\x74\x73\x2epro\144\x75\143\164\151d,\x20'1'\040A\x53 \163\x65\x71\165\x65\156\143\145\x5fno\x2c\x0d\x0a	\011  \x20\x20\x20 \x20\040\040 \040\040v\164\151g\145\x72_\141t\x74\141ch\x6de\x6e\x74s\x2e\x61tt\141\x63\x68\155\x65n\x74s\151d\054 n\141m\x65,\x20\160\x61\164\x68
\012\x09	\x20 \x20\x20  \x20  \040\x46\122O\x4d \x76\x74\151\x67\x65r_\x70\x72\x6fd\165\x63\164\x73\x0d\012\x09	\040 \040\040\040\040\x20  \040L\105\106\x54 \112\x4f\x49\x4e \166\164\x69\147\145\x72_s\x65\x61\x74\164\141\143\150men\x74\163re\154\x0d\012\x09\x09\x20\040 \x20\040 \040  \x20\x20\x20\117\x4e\x20\166\x74\x69g\x65r\x5f\x73\x65a\164\x74\141c\150\155\x65n\164\x73\162\145\154\x2e\x63r\155id=\x76\x74\x69g\x65\x72\137\x70\x72\x6f\x64\165\143t\163\x2epro\x64u\143\164i\144\x0d
\011\x09\x20\x20 \040\x20\040\x20\x20\x20\040\x4cEF\124\040J\117IN\040\x76\164\x69\x67e\x72\x5f\x61t\164\x61\143\x68\155\x65nt\x73\x0d
\x09\x09\x20\x20\x20\040\040 \040\x20\040\040\040\040O\116 vt\x69\x67\145\x72\137\x61t\164a\143\x68\x6den\164\x73.\141\x74\164\x61\x63h\x6d\145\156t\163i\x64\x3d\166\x74\151\147\x65\x72\x5fs\x65a\x74\x74\x61\x63\x68m\x65nts\x72\145\x6c.\x61\x74\x74achme\156\164\x73\x69d
\x0a\040\040 \x20\x20\040\x20\040\x20\x20 \x20 \x20 \040\040\040\111\x4eNE\122 \x4aO\111\116\x20\x76t\x69\x67\x65\x72\x5f\x63\162\155\145n\164i\164y
		\x09  \x20 \011\x4f\116\x20\166\164i\x67\145r\137\141\164t\141c\x68m\x65\x6e\x74\x73\056\141tt\141\x63\150\155e\x6e\164s\151\144=\x76\164ige\162_c\x72\x6d\145\x6e\x74it\x79\x2e\143\x72\x6d\x69d\x0d
\011\011 \x20\040\x20\040 \x20\040 \040\x57\x48E\122\105\x20\166\164\x69\x67\x65\x72\x5fcr\155\x65\156\x74it\x79\x2e\x64\x65l\x65\x74\x65d\0750\x20AND\x20v\164\x69ge\162\x5f\x70r\x6fdu\143\x74s\x2epr\157\x64uc\x74\x69d\x3d\x3f O\122\x44\105\122\x20\102\x59\040v\x74\x69ger_\141t\164\141\x63\x68m\145\156\164s\x2e\141t\164\x61c\150\155e\156t\163\151d";}$mainImgs = array();$bacImgs = array();$res = $this->db->pquery($sql, array($id));$products = array();while ($row = $this->db->fetchByAssoc($res)) {$products[$row["\160r\x6f\144uc\164\x69\x64"] . "#_#" . $row["s\145q\x75\x65\156\x63\145\137\x6eo"]][$row["\x61\164\x74ach\155\x65\156\164s\151d"]]["\160\141th"] = $row["p\141\x74\x68"];$products[$row["\x70\x72o\144\x75\x63\164\151\144"] . "\x23\x5f#" . $row["\163equ\x65\156ce\x5fn\x6f"]][$row["a\164t\x61c\x68ments\151d"]]["\156\x61\x6de"] = $row["\x6e\x61\155\145"];}$saved_sql = "\x53\105LEC\124 \x70r\x6fd\165\143t\x69d\x2c\x20\163\145q\165e\x6e\x63\x65\054 \x61\x74\x74a\x63\x68m\x65nt\x69\144,\x20\167\151dt\x68,\040h\x65\x69\x67\150\164 \x46\122OM vtig\x65r\x5fpd\146m\141\153e\x72\137\x69mag\x65\163\040W\110\x45\x52\105\040crmi\144\x3d?";$saved_res = $this->db->pquery($saved_sql, array($id));$saved_products = array();$saved_wh = array();while ($saved_row = $this->db->fetchByAssoc($saved_res)) {$saved_products[$saved_row["\160\162o\144\165c\164i\144"] . "\137" . $saved_row["\x73\145\x71\165ence"]] = $saved_row["\141\x74t\141c\150\155\x65\x6e\x74\x69d"];$saved_wh[$saved_row["\x70r\x6f\x64\165ct\x69d"] . "\x5f" . $saved_row["\x73\x65\x71\x75\145\x6e\x63\145"]]["\x77\x69\x64t\150"] = ($saved_row["\167\x69\x64t\x68"] > 0 ? $saved_row["\167i\144\x74h"] : "");$saved_wh[$saved_row["p\162\157duc\164id"] . "\x5f" . $saved_row["\x73e\x71\165\145n\143e"]]["\150\x65ig\150t"] = ($saved_row["h\145i\147\x68t"] > 0 ? $saved_row["h\x65\x69\147\150t"] : "");}foreach ($products as $productnameid => $data) {list($productid, $seq) = $x12("#\137#", $productnameid, 2);foreach ($data as $attid => $images) {if ($attid != "") {if (isset($saved_products[$productid . "\137" . $seq])) {if ($saved_products[$productid . "\x5f" . $seq] == $attid) {$width = $saved_wh[$productid . "\x5f" . $seq]["\167\x69\144t\x68"];$height = $saved_wh[$productid . "\x5f" . $seq]["\150\x65i\147ht"];$mainImgs[$productid . "\137" . $seq]["\x73\x72c"] = $images["\160at\150"] . $attid . '_' . $images["\156a\x6d\x65"];$mainImgs[$productid . "\x5f" . $seq]["\167\x69d\164h"] = $width;$mainImgs[$productid . "\137" . $seq]["\x68\x65i\x67h\x74"] = $height;}} elseif (!isset($bacImgs[$productid . "\137" . $seq])) { $bacImgs[$productid . "\137" . $seq]["\163\162\x63"] = $images["\160a\164\x68"] . $attid . '_' . $images["\x6ea\155\145"];}}}}return array($mainImgs, $bacImgs);}private function x1b($id) { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; if (isset($id) AND $id != "") {$query = "\123E\114\x45C\124 v\x74\151g\x65\x72\x5f\x61\x74\x74ach\155\145nts.\160\x61\x74\x68\054\x20v\x74ig\x65\x72\137a\164\x74\141\x63\150me\156\164s\x2e\x6ea\155\x65\x2c vt\151g\x65\x72_a\164t\x61c\150\x6de\x6e\x74\x73\x2e\141\x74\164ac\150\x6de\156t\163\x69\x64
 \040\040 \x20\040 \040\040\040\040\x20 \040F\122\117\x4d v\164\x69g\x65\162\x5f\x63on\x74a\143\164d\x65\164\141\151\154s\015
\040\040\040\x20\040\040\040 \x20\040\x20 \x20\040\111\x4e\x4eE\122\x20\112\117I\116\040\166\x74iger_\163\x65a\x74t\141\143\x68m\145\156ts\x72\x65\154\015\x0a \040\040\040    \040\040     \x20\x4f\x4e\x20\166tig\x65\x72_\143\157\156\x74\x61\143t\144\x65ta\x69l\163.co\x6et\x61c\164\151\x64\075\166tig\145\x72_\163\x65\x61\164t\x61c\150\x6de\x6et\163r\x65\154\056\143r\x6d\151d\015\012\x20 \x20 \040\x20\040\040\040\040\x20 \x20 \111\116\116\x45R\x20\x4aOI\116\x20\x76\164\x69\x67e\x72\137a\164\164\141c\x68\155\145\156\x74s
\x20\040\x20 \040 \040\x20 \x20\x20\x20\040 \x20 O\x4e vti\x67\x65\x72\x5fatt\x61\x63\150\155e\156t\163\056\x61\x74\x74a\x63h\155\145\156\164s\151d\x3dvt\x69\147\145\162_\163\x65a\x74\x74\141c\x68m\x65nt\x73re\154\x2e\141\164t\x61\x63\x68\x6d\145\156ts\151d
\012\x20 \040 \040 \x20\x20\040\040\x20   \x49NN\105\x52\040\112\x4f\x49\116\040v\164\x69g\x65\162_c\162\x6d\145n\x74it\171\015\012\040\040\x20\040  \x20\040   \x20\x20 \040\040ON\x20\x76\x74ig\x65\162_at\164a\x63\150\x6d\x65\x6e\164s\x2ea\164\164\141\x63\150ment\163i\144=vti\147e\162_\143r\x6d\x65\156t\151\164\171\056c\x72m\x69\x64
\012\040  \x20\040\040\x20\040\x20\x20\040\x20\x20 WHE\x52\x45\040\144\145l\x65t\145\x64=\x30 \x41\x4eD\x20v\x74\x69\x67\145\x72\137\143o\x6e\x74\x61\143\x74\144\x65\x74a\x69ls\x2ec\x6f\156\164\141\x63t\x69d=\077";$result = $this->db->pquery($query, array($id));$num_rows = $this->db->num_rows($result);if ($num_rows > 0) {$image_src = $this->db->query_result($result, 0, "p\x61\164\x68") . $this->db->query_result($result, 0, "\141\x74\x74a\143h\155\x65\x6et\163\x69\144") . "\137" . $this->db->query_result($result, 0, "\156\x61me");$image = "<\151m\x67\040s\162\x63\075'" . $this->site_url . "/" . $image_src . "'\057\x3e";return $image;}} else {return "";}}private function x1c($id) { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; if (isset($id) AND $id != "") {$sql = "s\145\154e\143\164\040vti\x67\145\162\x5fatt\141c\150\x6d\145\156\164\163.\052 \x66\x72\157m\x20v\164i\147\x65\162\x5f\x61\x74\x74a\x63h\155e\x6e\x74s\x20\154\x65\x66\164\x20\152o\151\156\040v\x74i\x67\145\162\x5f\x73a\x6c\145\163m\141\x6eat\x74\141c\150\155\x65\x6et\163\162e\x6c\040o\156\040v\x74ig\x65\x72\x5f\x73\141\x6ces\155\x61\x6ea\x74t\141ch\155\145\156t\x73\162el\056\141\164\x74\x61\x63\150\155\x65\156\164\163\151\144 = vt\151g\145\x72_\141t\x74\x61\x63\150\x6d\x65\x6e\x74\x73.\141\164\164\x61\x63\x68me\156\x74\x73id\x20\x77h\145\162\x65 vt\151\147\145r\137\163\x61le\163\155anatt\141\143\150m\145nts\162\145l.\x73\155\151d\075?";$image_res = $this->db->pquery($sql, array($id));$image_id = $this->db->query_result($image_res, 0, 'attachmentsid');$image_path = $this->db->query_result($image_res, 0, 'path');$image_name = $this->db->query_result($image_res, 0, 'name');$imgpath = $image_path . $image_id . "_" . $image_name;if ($image_name != '') { $image = '<img src="' . $imgpath . '" width="250px" border="0">';} else {$image = '';}return $image;} else {return "";}}private function x1d($id) { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $productid = $id;list($images, $bacImgs) = $this->x1a($productid, true);$sequence = "\061";$retImage = "";if (isset($images[$productid . "\137" . $sequence])) {$width = "";$height = "";if ($images[$productid . "_" . $sequence]["\167i\144t\x68"] > 0)$width = "\x20\x77\151dt\x68\x3d'" . $images[$productid . "\137" . $sequence]["wid\x74h"] . "' ";if ($images[$productid . "_" . $sequence]["\x68\x65\x69\x67\150\x74"] > 0)$height = " h\145\x69\147\150\x74\075'" . $images[$productid . "\137" . $sequence]["he\x69g\150\x74"] . "' ";$retImage = "\074\151\155\147\x20\x73\162c\075'" . $this->site_url . "/" . $images[$productid . "_" . $sequence]["src"] . "' " . $width . $height . "/\076";}elseif (isset($bacImgs[$productid . "\x5f" . $sequence])) {$retImage = "\x3c\x69\x6dg \163r\143\075'" . $this->site_url . "\x2f" . $bacImgs[$productid . "_" . $sequence]["\x73r\x63"] . "'\040w\151\144\164\x68\075'\x383'\040\x2f>";}return $retImage;} private function x1e($id) { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; if ($id != "") {$sql = "\123\105\x4c\105CT \165\x73\145\x72_n\141me\x20\x46RO\x4d \x76t\x69g\x65\162_\165s\x65\162\x73\x20\127\110\x45\x52\105\040\x69d\x3d?";$result = $this->db->pquery($sql, array($id));$ownername = $this->db->query_result($result, 0, "\165s\x65r\137n\141\155\x65");}if ($ownername == "") {$sql = "SEL\x45\103T \x67\x72o\165p\156a\155e\x20FR\117M\040\x76\164i\x67\145\162\137\147\162\x6f\x75\x70\x73\040\127H\105\x52\x45\040\147\162\157\165p\151d=\x3f";$result = $this->db->pquery($sql, array($id));$ownername = $this->db->query_result($result, 0, "\x67r\x6f\x75p\x6eame");} else {$ownername = getUserFullName($id);}return $ownername;}private function x1f($account_id) { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $accountno = "";if ($account_id != '') {$sql = "\123\x45L\x45\103\124 \x61\143\x63ou\x6e\164\x5f\x6eo\040\106R\117\115\040\166ti\x67\x65\162\137a\143co\x75\156t \x57\x48ER\x45\040\141c\x63\x6fu\156t\x69d\x3d\077";$result = $this->db->pquery($sql, array($account_id));$accountno = $this->db->query_result($result, 0, "\141\x63c\157\x75\x6et_\x6e\x6f");}return $accountno;}private function x20($str, $emodule) { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; require_once("m\x6f\144\165\x6ce\x73/P\104F\115\x61k\x65\x72\x2fP\104F\115a\x6b\x65\x72U\164i\154\163.\x70hp");return getTranslatedStringInLang($str, $emodule, $this->language);}private function x21($module, $focus) { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $inventory_table = $this->inventory_table_array[$module];$inventory_id = $this->inventory_id_array[$module];$res = $this->db->pquery("S\x45L\105\103\124\040\x63\x75\x72r\x65\x6e\x63y_\151\144,\x20" . $inventory_table . "\x2e\143on\166e\x72\x73\x69o\x6e\x5fr\x61t\x65 \x41S c\x6f\156\166\137ra\164e\x2c\040\x76ti\147\145r\137\x63\x75\162\162\145\x6ecy\137\x69\156\146o.\052\x0d\012\040\040\040    \x20    \040\x20 \x20\040 \x20\040 \x20\040 \x20\040  \x20\x20\040\040\x46\x52\117\115 " . $inventory_table . "
\012   \040\040\x20 \x20 \040\x20\x20  \040   \040\040\x20\040  \x20\040\040 \040\x20 \040\111\x4eN\x45R \x4a\x4fIN\x20\166\x74\151\x67\x65\162\137\x63\x75\x72r\145\156\143\171_\151n\146\x6f\040O\x4e " . $inventory_table . ".\143\165\162\x72\x65\156\x63\x79_id \x3d\x20\x76\x74ig\145\162_\143\x75\x72re\x6e\x63\171_\151\x6e\146\157\x2e\x69\x64\015
\040   \x20\040\x20\040 \x20  \040\x20\x20 \040\x20 \x20\040\040 \040\x20\040\x20  \x20  \x57H\x45RE\040" . $inventory_id . "=\x3f", array($focus->id));$currency_info = array();$currency_info["c\x75\162re\x6e\143\171\x5fid"] = $this->db->query_result($res, 0, "c\x75\162\x72e\156c\171\137i\x64");$currency_info["\x63onv\x65\162\163\151\157n\137\x72\x61\164\x65"] = $this->db->query_result($res, 0, "c\x6f\156\x76_\162\x61\x74\x65");$currency_info["c\x75\x72ren\143\x79\137\x6e\141m\x65"] = $this->db->query_result($res, 0, "c\165r\162\145\x6e\x63y\137\x6e\141me");$currency_info["\x63ur\x72\x65\156\x63y\x5fc\x6f\144\x65"] = $this->db->query_result($res, 0, "\x63\165rre\156c\171\x5f\x63\x6fd\145");$currency_info["\143\x75rr\145\x6ec\x79\x5fs\171\x6d\x62\157\x6c"] = $this->db->query_result($res, 0, "\x63\165\x72r\x65nc\x79\137\163\x79\x6d\142o\154");return $currency_info;}private function x22($module, $focus) { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $res = $this->db->pquery("S\105\114\105\103\124\x20ta\170\164yp\145 \x46R\117\115\x20" . $this->inventory_table_array[$module] . "\040WHE\122\105 " . $this->inventory_id_array[$module] . "\x3d?", array($focus->id));$taxtype = $this->db->query_result($res, 0, 'taxtype');return $taxtype;}private function x23($value) { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; if ($x1a($value)) {$number = $x1e($value, $this->decimals, $this->decimal_point, $this->thousands_separator);} else {$number = "";}return $number;}private function x24(&$focus, $record, $module) { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $result = Array();foreach ($focus->tab_name_index as $table_name => $index)$result[$table_name] = $this->db->pquery("\x53\x45\114\x45\x43T\040\052\x20\106R\117\115\x20" . $table_name . " \x57HE\x52E " . $index . "\075?", array($record));$tabid = getTabid($module);$sql1 = "\123E\x4c\105\x43T\x20f\x69\x65\154\x64na\x6d\x65,\x20\146\x69\145\154did\x2c\x20\146ie\154d\154a\x62\x65\x6c\x2c\040\143\x6flumn\x6e\x61me\x2c \x74\x61\x62\x6c\145\x6ea\155\x65\x2c u\x69\164\x79\x70\145,\x20type\157\146\x64at\x61\x2c \x70\162\145\163\x65\156\143\x65\x0d\012  \x20  \040 \040\040\x20\x20\040   \106\122\117\115 \166\x74\151\147e\x72_\146\151\x65\154\x64 \127\x48\x45\122E\x20\x74\141b\x69\144=\077";$result1 = $this->db->pquery($sql1, array($tabid));$noofrows = $this->db->num_rows($result1);if ($noofrows) {while ($resultrow = $this->db->fetch_array($result1)) {$fieldcolname = $resultrow["c\157\x6c\165\x6d\x6e\x6e\141\x6de"];$tablename = $resultrow["t\x61\142l\145n\141\x6d\x65"];$fieldname = $resultrow["\x66\151\145\x6c\144\x6e\x61\155\x65"];$fld_value = "";if (isset($result[$tablename]))$fld_value = $this->db->query_result($result[$tablename], 0, $fieldcolname);$focus->column_fields[$fieldname] = $fld_value;}}$focus->column_fields["re\x63o\162\x64\137\151\x64"] = $record;$focus->column_fields["\162e\143\x6fr\144\x5f\155\x6f\144\x75\x6c\x65"] = $module;}private function x25($value) { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; if ($x13("m\157\x64\x75le\x73\x2f\123\x65t\x74\x69\156\147\x73\057\x45d\151t\x54e\x72\155\x44\x65\x74\141\x69l\x73\056\x70\150p")) {$sql = "\x53E\x4cE\103\124 \x74a\x6e\x64\x63\x20\x46\122O\x4d \x76\164\x69\147\x65\162_\151n\x76\x65ntory\137t\141\156d\x63 \x57\x48\105\122E \x69\144='" . $value . "'";$res = $this->db->query($sql);$num = $this->db->num_rows($res);if ($num > 0) {$tandc = $this->db->query_result($res, 0, "\164\141ndc");} else {$tandc = $value;}} else {$tandc = $value;}return $tandc;}private function x26($efocus) { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $commentlist = "";$prefix = "";if ($efocus->column_fields["\162\145c\x6fr\144\x5f\155\x6f\x64\165\154\x65"] == "H\145lp\x44\145\x73\x6b") {$prefix = "tic\x6b\145t";} elseif ($efocus->column_fields["\x72eco\162d_\155\157\144u\x6c\x65"] == "Fa\161") {$prefix = "\x66a\x71";}if ($prefix != "") {$mod_lang = return_specified_module_language($this->language, $efocus->column_fields["\162\145\x63or\144\137m\157\144\x75\154e"]);$sql = "\x53\x45\114\105C\124\040*\x20\106\122\117M v\x74\x69\x67\145\x72_" . $prefix . "\x63\x6f\x6dme\156\x74s\x20W\110\105R\x45\040" . $prefix . "i\144\x3d" . $efocus->id;$result = $this->db->query($sql);while ($row = $this->db->fetchByAssoc($result)) {$comment = $row["c\x6fm\155ent\163"];$crtime = getValidDisplayDate($row["\143\162\x65\x61\x74\x65d\164\151m\x65"]);$body = "";if ($prefix == "t\x69\x63k\145\x74") {$author = $this->x1e($row["o\x77\x6e\x65\x72\151\144"]);$body = $comment . "\x3cb\162\x20\057>" . $mod_lang["\114\102\x4c\137A\125\124\x48\117\122"] . ": " . $author . "\074\x62\x72\x20\057\x3e" . $mod_lang["\103\162\x65\x61\164\x65d \x54\151\x6d\145"] . ":\x20" . $crtime . "\x3cb\162\040\057\x3e\074\x62\162\040/>";} else {$body = $comment . "<br\x20\x2f\x3e" . $mod_lang["\103r\145\141\164ed \x54\x69\x6de"] . "\x3a " . $crtime . "\x3c\142r /\x3e<\142r\x20\057>";}$commentlist.=$body;}}return $commentlist;}private function x27($folderid) { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $sql = "\123ELE\x43T\040\x66o\x6c\144e\x72n\x61m\x65 FR\117\x4d\x20\x76\x74ig\x65\x72_\x61\164\164\141ch\x6d\x65\156\x74s\x66\157\154d\x65r\x20WH\105\x52\x45\040\x66\x6fl\144\x65\162\x69d\x3d" . $folderid;return $foldername = $this->db->query_result($this->db->query($sql), 0, "\x66\157\154d\145r\156a\155e");}private function x28() { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; if ($x1a($x28($this->content, '[CUSTOMFUNCTION|'))) {require_once("c\x6c\141\x73s\x65\x73\057\x73\x69mp\x6c\145\x5f\150\x74ml\137\x64o\x6d\056p\150\160");foreach ($x14('modules/PDFMaker/functions/*.php') as $file) {include_once $file;}$this->replacements["\133C\125\123T\117\x4d\x46UN\103\124IO\x4e\x7c"] = "\x3c\x63u\x73\164omf\x75\x6ec\164\x69\157\x6e\076";$this->replacements["\x7cC\x55S\x54\117\115\106\125N\103T\x49\x4f\x4e\x5d"] = "\x3c/cu\x73tom\146\165n\x63ti\x6f\x6e\x3e";$this->x15();$html = str_get_html($this->content);foreach ($html->find("\x63\x75\163\164\157m\146\x75\x6e\x63\x74\x69on") as $customfunction) { $Params = $this->x29($x2c($customfunction->plaintext));$func = $Params[0];unset($Params[0]);$replacement = $x0f($func, $Params);$customfunction->outertext = $replacement;}$this->content = $html->save();}}private function x29($val) { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $Params = array();$end = false;do {if ($x2a($val, '|')) {if ($val[0] == '"') {$delimiter = '"|';$val = $x2b($val, 1);} elseif ($x2b($val, 0, 6) == '&quot;') {$delimiter = '&quot;|';$val = $x2b($val, 6);} else {$delimiter = '|';}list($Params[], $val) = $x12($delimiter, $val, 2);} else {$Params[] = $val;$end = true;}} while (!$end);return $Params;}public function getFilename() { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $this->content = $this->filename;$this->replacements["\044\043T\105\x4dPL\x41TE\x5f\x4eAM\105\x23\044"] = $this->templatename;$this->replacements["$\x23\104D\055\x4d\115\x2d\131\131\x59\131#$"] = $x11("d\055\155\055Y");$this->replacements["$#MM\055\x44D\055\x59\131Y\131\x23$"] = $x11("m\x2dd\055\131");$this->replacements["\044\043\x59\131\x59Y-M\x4d-\104D#\x24"] = $x11("\x59\055\x6d\x2d\144");$this->replacements["\044" . $x27($this->module) . "\137C\x52\x4dI\104$"] = $this->focus->id;$this->x10($this->module, $this->focus);$this->replacements = array();$this->replacements["\x5c\162\x5cn"] = "";$this->replacements["\x5c\156\134\x72"] = "";$this->replacements["\134n"] = "";$this->replacements["\x5c\x72"] = "";$this->x15();return $x23(" ", "\x5f", $x2b($x26($x15($this->content, ENT_QUOTES, $this->def_charset)), 0, 255));}private function x2a($val) { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; return $x1c($val);}private function x2b() { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; include_once("m\x6f\x64ul\145\x73\x2fP\x44\106\115\141\153\145\162\057R\145\x6c\102\154\x6f\x63\x6bRun\056\160\x68\160");if ($x28($this->content, "\x23\x52E\x4c\102L\x4f\x43K") !== false) {$x1f("|\043R\105\x4cB\x4cO\x43\x4b\x28[\060\x2d\071\x5d+)\x5f\123\x54A\122\x54\x23|\x55", $this->content, $RelatedBlocks, PREG_PATTERN_ORDER);if ($x10($RelatedBlocks[1]) > 0) {$ConvertRelBlock = array();foreach ($RelatedBlocks[1] AS $r => $relblockid) {if (!$x19($relblockid, $ConvertRelBlock)) {$sql_rb = "\123\105L\105\x43\124 \x73\x65c\155\157\144u\x6c\145 \x46\122\117M\x20\x76\x74i\147\x65\162\137\160d\146m\x61ke\x72_\x72\145\154\x62\x6c\x6f\143\153s\040\127\x48\105\x52\x45 r\x65\154\x62\154\x6f\x63kid \x3d '" . $relblockid . "'";$secmodule = $this->db->query_result($this->db->query($sql_rb), 0, "\x73ecm\157d\x75\x6c\145");if ($x28($this->content, "#\122E\x4cB\114O\103\x4b" . $relblockid . "\137\123\124\101\122\x54\043") !== false) {if ($x28($this->content, "#RELBL\117CK" . $relblockid . "\137\x45\x4e\104\x23") !== false) {$tableDOM = $this->x2c($relblockid);$oRelBlockRun = new RelBlockRun($this->focus->id, $relblockid, $this->module, $secmodule);$oRelBlockRun->SetPDFLanguage($this->language);$RelBlock_Data = $oRelBlockRun->GenerateReport();$ExplodedPdf = array();$Exploded = $x12("\043R\x45\x4cB\x4c\x4fCK" . $relblockid . "\x5fS\124\101\122T\x23", $this->content);$ExplodedPdf[] = $Exploded[0];for ($iterator = 1; $iterator < $x10($Exploded); $iterator++) {$SubExploded = $x12("#\x52\x45L\102\x4c\117\x43\x4b" . $relblockid . "\137\x45\x4e\104\x23", $Exploded[$iterator]);foreach ($SubExploded as $part)$ExplodedPdf[] = $part;$highestpartid = $iterator * 2 - 1;$ProductParts[$highestpartid] = $ExplodedPdf[$highestpartid];$ExplodedPdf[$highestpartid] = '';}if ($x10($RelBlock_Data) > 0) { $this->relBlockModules[$relblockid] = $secmodule;foreach ($RelBlock_Data as $RelBlock_Details) {foreach ($ProductParts as $productpartid => $productparttext) {$show_line = false;foreach ($RelBlock_Details AS $coll => $value) { if ($x2c($value) != "-" && $coll != "li\163tp\162i\x63\x65") {$show_line = true;} $productparttext = $x24("$" . $coll . "$", $value, $productparttext);}if ($show_line)$ExplodedPdf[$productpartid].=$productparttext;}}}$this->content = $x18('', $ExplodedPdf);}}$ConvertRelBlock[] = $relblockid;}}}}}private function x2c($relblockid) { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; require_once("\x63l\x61\x73\x73\145s\x2f\x73\x69\x6d\x70le_\150t\155\154\x5f\144o\155\x2e\x70\x68\x70");$html = str_get_html($this->content);$tableDOM = false;foreach ($html->find("\164\x64") as $td) {if ($x2c($td->plaintext) == "\043\x52\105\114\102L\117\103\x4b" . $relblockid . "\x5fST\101R\x54#") {$td->parent->outertext = "#R\105\x4c\102\114\x4fC\x4b" . $relblockid . "_\123\124\x41\x52T#";}if ($x2c($td->plaintext) == "\x23\x52\105\x4cB\114OC\x4b" . $relblockid . "_\x45\116D\x23") {$td->parent->outertext = "\x23\122EL\102\114OCK" . $relblockid . "\x5f\105\116\x44\043";}}$this->content = $html->save();return $tableDOM;}private function x2d() { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; require_once("\x63\154\141\x73\x73es\057simp\154\145_\150\x74m\154\137\x64\157m\x2e\x70\x68p");$html = str_get_html($this->content);foreach ($html->find("\x74d") as $td) {if ($x2c($td->plaintext) == "\043\114\x49\x53\124\126I\105WB\x4c\117\103\x4b\x5f\x53\124\101R\x54#")$td->parent->outertext = "\x23L\x49S\124\x56\x49\105WB\114O\x43K\x5fS\124A\x52\124#";if ($x2c($td->plaintext) == "#\x4cIS\124\126I\x45\x57\x42L\117\x43\113\x5fEND\043")$td->parent->outertext = "#LIS\x54V\111\x45\x57BL\117\103\113_\105N\x44#";}$this->content = $html->save();}private function x2e() { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; require_once("c\x6c\x61\x73se\163\057\163im\160\x6ce\x5f\x68\164\155\x6c_\x64\157m\x2e\x70hp");$html = str_get_html($this->content);foreach ($html->find("\164\144") as $td) {if ($x2c($td->plaintext) == "#\x56A\x54\102LO\x43K\x5f\123T\101\122\x54\043") {$td->parent->outertext = "\043\x56\x41\x54\102L\117\x43\113\137\123\124A\122\x54\x23";}if ($x2c($td->plaintext) == "\043V\x41\124B\114\x4f\103\113_\105\116\104\043") {$td->parent->outertext = "\x23\126\x41\124\x42L\x4fC\x4b\x5f\x45\116\x44#";}}$this->content = $html->save();}private function x2f() { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $tacModules = array();$tac4you = $x1a(getTabId("\x54\141c4y\x6f\x75"));if ($tac4you == true) {$tacSql = "\x53\x45\x4cE\x43\x54\040\x74\145\170\164\x20F\x52O\115\x20v\x74\151\x67er\x5f\164\x61\x63\064\x79o\x75_te\x78t\163\x20\x57\x48E\x52\x45\040\x69\144=\077";$tacResult = $this->db->pquery($tacSql, array($this->focus->id));$tacText = $this->db->query_result($tacResult, 0, "\x74\x65x\x74");$this->replacements["\044" . $x27($this->module) . "_\x54\101\x43\x34Y\x4fU\x24"] = $x15($tacText, ENT_QUOTES, $this->def_charset);}}private function x30() { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $desc4youModules = array();$desc4you = $x1a(getTabId("\104\145\163cr\x69p\164\x69\157\156\x734\x79ou"));if ($desc4you == true) {$descSql = "\123\x45\x4c\105\x43\124\040te\170\164\040\x46\122\x4f\x4d\x20\x76\164\151g\145\x72_\144e\x73c\162ipti\157\x6e\163\x34y\x6f\x75\137\x74e\170\164s\040\x57HE\122E \151d\x3d\077";$descResult = $this->db->pquery($descSql, array($this->focus->id));$descText = $this->db->query_result($descResult, 0, "\164ex\x74");$this->replacements["\x24" . $x27($this->module) . "\x5f\x44E\x53\103\x34\x59\117\125\x24"] = $x15($descText, ENT_QUOTES, $this->def_charset);}}private function x31() { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $ModCommentsModules = array();$ModComments = $x1a(getTabId("\x4d\x6fdCo\155\x6de\156ts"));$string_comments = "";if ($ModComments == true) {$sql = "SELE\103\124\x20\162\x65\x6cm\x6fdul\x65\x20\106\122\x4f\x4d\x20vti\x67\x65r_\x66\151\145\154d\155\x6f\x64u\154er\145\x6c W\110E\x52\x45\040\155od\165\x6ce\075'\x4d\157dC\157\155\x6d\x65\156t\163'\040\x41\x4e\x44\x20\x72\x65lmod\x75\154e \075\x20\x3f";$result = $this->db->pquery($sql, array($this->module));if ($this->db->num_rows($result) > 0) {$string_comments = $this->x32($this->focus->id);}}$this->replacements["\044" . $x27($this->module) . "\137\115\x4f\104C\117M\115\105\x4e\x54S$"] = $x15($string_comments, ENT_QUOTES, $this->def_charset);}private function x32($parent_id) { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $string_comments = "";if ($x13("\x6dod\165le\x73/\x4do\144C\157\155\155\x65\x6e\x74\163\057\115o\144C\x6fm\155e\156\164s.ph\x70") == true) {require_once("\155\157\144u\x6c\x65\163/\x4d\x6fdC\157mm\x65\x6e\x74\163\057\115\157d\x43\157mmen\x74s\x2e\160\150\x70");$moduleName = "M\x6f\144Co\x6dm\145nt\x73";$entityInstance = CRMEntity::getInstance($moduleName);$queryCriteria = $x22(" O\122D\x45\x52\040B\x59\040\045s.%\x73 \104\105S\103 ", $entityInstance->table_name, $entityInstance->table_index);$query = $entityInstance->getListQuery($moduleName, $x22("\040\x41\x4eD\x20%\x73\056r\145\154\141t\x65d\137t\157\075\x3f", $entityInstance->table_name));$query .= $queryCriteria;$result = $this->db->pquery($query, array($parent_id));$instances = array();if ($this->db->num_rows($result)) {while ($resultrow = $this->db->fetch_array($result)) {$tmpMc = new ModComments_CommentsModel($resultrow);$string_comments .= "<\160\076\133" . $tmpMc->author() . ": " . $tmpMc->timestamp() . " \x5d<br\x20\057>" . $tmpMc->content() . "</p\076";}}}return $string_comments;}private function x33($module, $focus) { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c;  if (isset($focus->column_fields["\x63u\x72r\145\156\x63\171\137\151\x64"]) && isset($focus->column_fields["\x63\157\156v\x65rsi\x6f\156\137r\141te"]) && isset($focus->column_fields["\x68d\x6e\107\x72a\156\144\124\157t\x61\154"])) {$this->inventory_table_array[$module] = $focus->table_name;$this->inventory_id_array[$module] = $focus->table_index;}}private function x34($module, $focus, $is_related = false) { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c;  if (!isset($this->inventory_table_array[$module]))$this->x33($module, $focus);if (!isset($this->inventory_table_array[$module]))return array();if(empty($focus->id))return array();$prefix = "";if ($is_related !== false)$prefix = "\122\137" . $x27($is_related) . "_";$this->replacements["\044" . $prefix . "S\125\102\124OTA\114\x24"] = $this->x23($focus->column_fields["\x68\144\156S\165\x62\x54o\164\141\x6c"]);$this->replacements["$" . $prefix . "\124\x4f\124\x41L\x24"] = $this->x23($focus->column_fields["\x68\144\156G\x72\x61n\144To\x74\x61\154"]);$currencytype = $this->x21($module, $focus);$currencytype["\143urr\x65n\143\x79\137\163\x79\x6d\x62o\x6c"] = $x23("â\x82¬", "\x26\145\165\x72o\x3b", $currencytype["c\165\x72r\x65\156\x63\x79\137\163\x79mb\157\x6c"]);$currencytype["cu\162re\156\143\x79\137\x73y\x6d\x62\x6fl"] = $x23("\xc2\xa3", "&\160o\x75\156d;", $currencytype["\143\165\162r\145\x6ec\171_\163\x79m\x62ol"]);$this->replacements["\x24" . $prefix . "\x43UR\x52\105\x4e\103\x59\x4eAM\105\044"] = getTranslatedCurrencyString($currencytype["c\165r\x72\x65n\x63y\137\156a\155\145"]);$this->replacements["\x24" . $prefix . "\103\125\x52\x52\x45\x4eC\x59\x53\x59\x4d\102O\x4c\x24"] = $currencytype["c\x75rr\x65\156cy_\x73\x79\155\142o\154"];$this->replacements["$" . $prefix . "C\x55R\122ENC\x59C\x4f\x44\x45$"] = $currencytype["\143u\162\162e\x6e\143\x79_\143\157\144\x65"];$this->replacements["$" . $prefix . "\101\x44\x4a\125\123\124\115\105N\x54\044"] = $this->x23($focus->column_fields["\x74\170\164Ad\x6au\x73\x74m\145\x6e\x74"]);$Products = $this->x18($module, $focus);$this->replacements["\044" . $prefix . "\x54OT\101L\x57I\124H\x4fU\x54\x56\101\124\x24"] = $Products["\124\117\x54AL"]["T\x4fTA\x4c\x57I\x54H\117\x55T\126A\x54"];$this->replacements["$" . $prefix . "\126\101\124$"] = $Products["TO\124\x41\114"]["T\101X\124O\124A\x4c"];$this->replacements["\x24" . $prefix . "V\x41\124\120\x45\x52\x43\105NT$"] = $Products["\124\x4f\124AL"]["\x54\x41\130\124\117\124\101L\120E\x52CE\x4e\x54"];$this->replacements["\x24" . $prefix . "\124\x4f\124\x41\x4c\x57I\124\110VA\124\x24"] = $Products["TO\124AL"]["\124\117\x54AL\x57I\124\x48\126\101\x54"];$this->replacements["$" . $prefix . "S\110\x54\101\130\101M\x4f\x55\116\124\044"] = $Products["T\117TAL"]["\x53H\124\101\130\x41MO\x55\x4eT"];$this->replacements["\044" . $prefix . "\x53\x48T\x41X\x54\117\124A\x4c\x24"] = $Products["T\x4f\x54\x41\x4c"]["\123\110TAXT\117TA\x4c"];$this->replacements["\044" . $prefix . "\124\x4fTA\114\104\111\x53\103O\x55\116T\x24"] = $Products["T\x4fT\x41\114"]["F\x49NALD\111\123\103O\125\x4eT"];$this->replacements["$" . $prefix . "TO\x54\x41L\x44\111S\x43\117\x55NT\x50\105RC\x45\x4eT$"] = $Products["\x54OT\101\114"]["\x46\x49\x4e\x41\114D\x49\x53\x43OU\116\x54P\105\x52\x43\105\116T"];$this->replacements["\044" . $prefix . "\x54\117\124\x41L\x41F\x54ER\x44IS\103O\x55NT\044"] = $Products["\x54O\x54A\114"]["\124\117T\101L\101F\x54\x45\x52DI\123C\117\125\116T"];$this->x15(); if ($is_related === false) { if ($x10($Products["\x54\117\124AL"]["VAT\x42\114O\x43\x4b"]) > 0) {$vattable = "\x3c\164\141\142\154e\x20\x62\x6f\x72\144\x65\x72='\x31' \x73\x74yl\x65\x3d'\142\x6f\x72\144\x65r\x2dco\154\x6c\141p\x73e\x3a\x63\x6f\154\154a\160\163\145\x3b' \143el\154pa\144\x64\151\156g\x3d'\063'>";$vattable .= "\074t\162>
\012\x20 \x20\x20\x20\x20 \040\x20\x20 \x20 \040\040\x20\040\040\x20\x20 \x20 \040\040 \x20\x20\040\040 \x20\x3c\164d\040\156\x6fw\x72a\160\x20a\154\x69g\156\075'\x63e\x6e\x74e\x72'\076" . $this->app_strings["\x4e\x61\155\145"] . "<\x2ft\x64\076\015
\x20 \x20\x20\040\040 \x20\040\040 \x20   \x20\040\040 \040\040\x20 \040\040 \040\040  \040\040<\x74d\x20\156\x6fwra\x70 a\154\x69\x67n\x3d'c\145nt\145r'\076" . $this->mod_strings["\x4c\x42\114\137\x56\x41T\102\x4cO\x43\113\137\126\x41\124\x5f\x50ER\x43ENT"] . "\074/\x74d\076\x0d\012\x20 \x20\040\040 \x20 \040  \x20  \040\x20\x20 \x20 \x20 \040\x20 \x20\040\040\x20 \x20\x20\x3c\164d \x6e\x6f\x77ra\160\x20\141\x6c\151g\x6e='\x63\145\156t\x65\x72'>" . $this->mod_strings["LBL_\126\101\124\x42L\x4fC\113\137\123\x55\115"] . "\040\x28" . $currencytype["cu\x72r\x65\156c\171\x5f\163y\155\142\157\154"] . "\051" . "\x3c\x2ft\x64\076\015\012\x20\040\040\x20\x20\x20\x20\x20\x20\x20\040\040\x20\040\040\x20\x20\040\x20    \040  \x20\040 \040\040\x20\x3c\164\144\x20\156\157\x77\x72\x61\x70\040\141\154\151\147n\075'\143\145\156\x74\x65\162'\x3e" . $this->mod_strings["\114\102\x4c\137V\x41T\x42\x4c\117\x43K_\126\101T\x5f\126\101\x4cUE"] . " \050" . $currencytype["c\x75\x72r\x65\x6e\x63\171\137\163y\x6db\157l"] . "\051" . "\074\x2f\164\144\076
\012\x20 \040 \040\040\040\x20\040\040\040\040   \040\040\040\x20\x20\040\x20 \040\040\x20  \040\x20<\x2f\164\162\076";foreach ($Products["\x54OTA\x4c"]["\126\x41T\102\114\x4fC\x4b"] as $keyW => $valueW) {if ($valueW["\156e\x74t\157"] != 0) {$vattable .= "\074\164\162\x3e\x0d\x0a    \x20\x20 \x20\040 \040\040  \x20\040  \040\x20\x20\x20 \040\x20\040\x20\040\040\040\x20\x20\x20\040\x20\040 \040\x20\040<t\144 \156o\167\162\141\160\040\x61l\151gn\075'\154\x65\x66\x74'\x20\x77\151\144\x74h='2\060\045'\076" . $valueW["\x6c\x61\x62\x65\x6c"] . "<\057\164\144\x3e\x0d\012\040 \040\x20\040   \040 \x20\x20\x20\x20\x20  \x20\040\040  \x20\x20\x09\011\x09	<\x74\144\x20n\157\167\162a\160\040al\151\x67\x6e\075'r\x69\x67\150\164'\040\167id\x74\x68\x3d'\062\065\x25'\076" . $this->x23($valueW["\x76\x61\x6cu\x65"]) . "\040%<\x2ft\x64>
\012\x20\040\x20\x20\x20\040\x20\040\x20 \040 \x20\040\x20\x20   \040\x20\x20\040\x20\040\x20   \x20\x20  \040\x20\040\040 \x20\040<td \x6e\157\x77ra\160 a\x6c\x69\147n\x3d'\162i\x67\150\164' \x77\151\x64\x74\150\075'\063\060%'\x3e" . $this->x23($valueW["\156et\x74o"]) . "\074\057t\144>\015\012\040\x20 \040\x20\040 \x20\040\x20\040\x20\x20\x20\040\x20\040 \040\040  \x20\040\x20\040\040\x20  \040\x20\x20\x20  \040  \040\x3c\x74\x64\040\x6e\x6fw\162a\x70 alig\x6e='\x72i\147\x68\x74' w\151d\x74\150='2\065\x25'>" . $this->x23($valueW["\166\x61t"]) . "</t\x64>\x0d\012\040\040\040\040  \x20    \040\x20\040\040\040\040\x20 \040\x20\x20\x20\x20\x20  \040\040\x20\x20\040 \040\x20\x20\040\x20\x3c/t\x72\x3e";}}$vattable .= "\074\x2ft\x61\142le\076";} else {$vattable = "";}$this->replacements["\x24" . "V\101\124\x42\114\x4f\103\x4b\x24"] = $vattable;$this->x15(); if ($x28($this->content, "\x23V\x41\x54\x42\x4c\117\x43K\137\x53T\x41\x52\x54\043") !== false && $x28($this->content, "#\x56\x41\x54\102\114\x4f\x43K\x5fE\x4e\x44\x23") !== false) {$this->x2e();$VExplodedPdf = array();$VExploded = $x12("\x23\x56A\x54\102\x4cOC\113_\x53T\x41\122T\x23", $this->content);$VExplodedPdf[] = $VExploded[0];for ($iterator = 1; $iterator < $x10($VExploded); $iterator++) {$VSubExploded = $x12("#\126AT\102LO\x43K_\105\116\x44\043", $VExploded[$iterator]);foreach ($VSubExploded as $Vpart) {$VExplodedPdf[] = $Vpart;}$Vhighestpartid = $iterator * 2 - 1;$VProductParts[$Vhighestpartid] = $VExplodedPdf[$Vhighestpartid];$VExplodedPdf[$Vhighestpartid] = '';}if ($x10($Products["\x54\x4fT\x41L"]["\x56\x41T\102L\x4fC\x4b"]) > 0) {foreach ($Products["\x54\x4f\124A\114"]["\126\x41T\102L\x4f\103\x4b"] as $keyW => $valueW) {foreach ($VProductParts as $productpartid => $productparttext) {if ($valueW["\x6e\x65\x74\x74\x6f"] != 0) {foreach ($valueW as $vColl => $vVal) {if ($x1a($vVal))$vVal = $this->x23($vVal);$productparttext = $x23("$" . "\126A\124B\x4c\117\103\113_" . $x27($vColl) . "$", $vVal, $productparttext);}$VExplodedPdf[$productpartid].=$productparttext;}}}}$this->content = $x18('', $VExplodedPdf);}}return $Products;}private function x35() { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c; $this->replacements["\044" . "MU\x4cT\111\x43O\115\x50A\x4eY_C\117\x4dP\101\x4e\x59N\101M\x45" . "$"] = '';$this->replacements["\x24" . "\115\125\114\x54\111C\117M\120A\x4e\131\x5f\x53T\122EE\124" . "\044"] = '';$this->replacements["$" . "M\125L\x54\111\x43\117\x4d\120\x41\x4eY_\103\111\124Y" . "$"] = '';$this->replacements["\044" . "\115\x55\x4cT\x49\103\117\x4dP\101\x4e\131_\x43\117D\x45" . "\044"] = '';$this->replacements["$" . "\115\x55LT\x49\x43\117\x4dP\x41\116Y_\x53\x54\101\124E" . "\x24"] = '';$this->replacements["\x24" . "M\x55L\124\111C\x4f\x4dP\101\x4e\x59\137\x43O\125N\x54\x52\131" . "\x24"] = '';$this->replacements["\x24" . "\115U\x4c\124IC\117MP\101\116\x59_\120H\x4f\x4eE" . "\044"] = '';$this->replacements["$" . "\115\x55\x4cT\111\103OMPA\x4e\131_\106A\x58" . "$"] = '';$this->replacements["$" . "\x4d\125\x4c\x54IC\x4fM\x50ANY\137E\115\101\x49\114" . "\x24"] = '';$this->replacements["$" . "\115U\114\124I\103\x4fMPA\116\x59\137W\x45BS\x49\124\x45" . "$"] = '';$this->replacements["\044" . "MU\x4cTICOM\120AN\131_L\x4fGO" . "$"] = '';$this->replacements["$" . "MU\x4c\124\111\x43\117\115PA\x4e\131\x5f\x53T\101M\120" . "$"] = '';$this->replacements["$" . "M\125\114T\111\x43\117\115\120\101\116\x59\x5f\102A\x4eK\x4e\101M\105" . "\044"] = '';$this->replacements["$" . "\115\x55\x4cTI\103\117\x4dP\101N\131\137\x42\x41NK\101CC\x4fU\116\x54N\x4f" . "$"] = '';$this->replacements["\x24" . "MU\x4c\x54\x49\x43\117\115P\x41\x4eY\137IB\x41\116" . "\x24"] = '';$this->replacements["$" . "M\x55\114T\x49\103\117\115\120\x41N\x59\x5f\x53WIF\x54" . "\x24"] = '';$this->replacements["$" . "\x4d\x55\x4cT\111\103\117\115\x50\101\x4e\x59\137\122E\107\111\x53\x54RA\124\x49\x4f\116\116\x4f" . "\x24"] = '';$this->replacements["\044" . "\x4d\x55\x4c\x54I\x43\117\x4dP\x41\116\131\137VA\124\116O" . "\x24"] = '';$this->replacements["$" . "\115\125\114TIC\117\115P\101\x4e\x59\x5f\124\101\130I\x44" . "\044"] = '';$this->replacements["\x24" . "\x4dU\x4c\x54\111CO\115\120\x41\x4eY\137\x41\x44\x44\x49\x54I\x4fN\x41\x4c\x49\x4e\106O\x52\x4dA\124\111\x4fN\123" . "\044"] = '';if (getTabId('MultiCompany4you') && vtlib_isModuleActive('MultiCompany4you') && isset($this->focus->column_fields) && $this->focus->column_fields > 0) {require_once('modules/MultiCompany4you/MultiCompany4youUtils.php');$roleid = getCompanyRole($this->focus->column_fields['assigned_user_id']); $res = $this->db->pquery("SE\114EC\124 *\040\106\x52\x4f\x4d \166\164ig\145r\137\155\165\x6c\x74\151\x63\157\155p\x61n\x79\x34y\157\x75\x20W\110E\x52\x45 rol\x65\x3d\x3f \x41\x4e\x44\040\x64\145\x6cet\145d\0750", array($roleid));$row = $this->db->fetchByAssoc($res); foreach ($row as $key => $value) {switch ($key) {case "\x6co\147\x6f":continue (2);break;case "\x6co\147\x6f\x6ea\155e":case "s\164\x61\x6dpn\141me":$key = $x2b($key, 0, -4);$value = "\x3c\x69mg sr\143='tes\x74/\x6c\157g\x6f\057" . $value . "'\076";break;}$this->replacements["$" . "\x4dUL\x54\x49\x43\x4f\115\x50A\116Y\137" . $x27($key) . "\x24"] = $value; }$this->x15();}}private function x36() { global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12,$x13,$x14,$x15,$x16,$x17,$x18,$x19,$x1a,$x1b,$x1c,$x1d,$x1e,$x1f,$x20,$x21,$x22,$x23,$x24,$x25,$x26,$x27,$x28,$x29,$x2a,$x2b,$x2c;  $this->replacements['$USERS_IMAGENAME$'] = $this->x1c($this->focus->column_fields["\x61\x73\163\151g\156\x65\144_use\162\x5f\x69\144"]); $this->replacements['$R_USERS_IMAGENAME$'] = $this->x1c($_SESSION["a\x75\164h\x65\156tic\x61\x74\145d_u\163\145\x72_\151d"]);switch ($this->module) {case "\x43\x6f\x6e\164a\x63ts":$this->replacements['$CONTACTS_IMAGENAME$'] = $this->x1b($this->focus->id);break;case "P\x72o\144u\143\164\x73":$this->replacements['$PRODUCTS_IMAGENAME$'] = $this->x1d($this->focus->id);break;}}}
?>