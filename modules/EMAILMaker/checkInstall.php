<?php
/*********************************************************************************
 * The content of this file is subject to the EMAIL Maker license.
 * ("License"); You may not use this file except in compliance with the License
 * The Initial Developer of the Original Code is IT-Solutions4You s.r.o.
 * Portions created by IT-Solutions4You s.r.o. are Copyright(C) IT-Solutions4You s.r.o.
 * All Rights Reserved.
 ********************************************************************************/

$x0b="\x61\142s"; $x0c="\x64\x61\x74e"; $x0d="\145rr\157\x72_r\x65\x70\x6f\162\x74\151\156g"; $x0e="\145\x78p\x6c\157\x64e"; $x0f="\155\1445"; $x10="\x73\164r_\162\x65p\x6c\x61\x63e"; $x11="\163t\x72\x6c\145\156"; $x12="\x74\x69me"; 
$thm="t\150\x65m\x65\137\x70\x61\x74h";$mod_str="\x6d\157\x64_\x73\x74\162\151ngs";$app_str="a\x70\x70\137st\162\151\156\147\x73";$db="\x61d\142";$vcv="\x76\x74\x69g\145\x72\137c\165rr\x65n\x74_\x76\145\x72\163\151on";$salt="\x73\x69te_\125\x52L";$list_per = "list_p\x65\x72m\151\163\163i\x6fn\163";$p_e = "\x70\137\x65\x72r\x6f\162s"; global $$thm,$$mod_str,$$app_str;$mod=$$mod_str;$app=$$app_str;$x0d(E_ERROR | E_PARSE);require_once("\151n\143\154\165d\145/\x6e\165so\141\160\x2f\156\165\x73\157\141p\056p\x68\160");require_once("Sma\162\164\x79\x5f\163\x65\164\x75\x70.\160\150p");global $client;$client = new soapclient2("\x68\164\x74p\x3a\057/\x77\167\x77\056\x63\x72m\x34y\x6f\x75.\163\x6b\057\x45M\x41I\x4c\x4daker/I\124\x534\131\x6f\165\x57\x53\056\x70hp", false);$client->soap_defencoding = 'UTF-8';$err = $client->getError();$smarty = new vtigerCRM_Smarty();$theme_path="\x74\x68\x65\x6d\x65\x73\x2f".$$thm."\057";$image_path=$theme_path."im\x61\x67\x65\163\x2f";$smarty->assign("T\x48\x45\x4d\x45", $theme_path);$smarty->assign("IM\x41G\105_P\101TH", $image_path);$smarty->assign("M\x4f\104",$mod);$smarty->assign("\x41\x50\120",$app);function x0b($type,$vcv2,$control,$url){ global $x0b,$x0c,$x0d,$x0e,$x0f,$x10,$x11,$x12; global $client;$time = $x12();$params = array("ke\x79"=>$_REQUEST["k\145\x79"], "t\x79p\x65"=>$type,"v\x74\x69\x67\145\162"=>$vcv2,"\145\155a\151\154\155\141\x6be\x72"=>$control,"u\162\154"=>$url,"\164\151\155e"=>$time);$validate = $client->call("a\143t\x69\166\141te_l\151cen\163e", $params); if ($validate != "\x69n\166\x61l\151\x64\141t\145\x64" && $validate!="\x76\141\x6c\151d\x61\x74\145\x5f\145r\162"){$V = $x0e("\137",$validate);$validate = "\x69n\166\141\154\151\x64\x61t\x65\144";$minus = $x0c("\131\x79",$time);$type_len = $x11($type);$url_len = $x11($url);$kontrola = $minus; $kontrola -= ($type_len + $url_len); $kontrola -= $time;if ($V[1] == $x0b($kontrola)) $validate = $V[0];} return $validate; }if($_REQUEST["in\x73\164\141\x6c\x6c\x74y\160\145"]=="v\x61\154i\x64\x61te" && isset($_REQUEST["\x6b\145\171"])){$validate="\x69\156v\x61\x6ci\x64at\145\x64";include_once("\166\x65r\163\151\157\x6e\x2ephp");$vers="\x76e\x72\x73ion";$control = $x10(" ","\x5f",$$vers);$url = $x0f("\167e\x62\057".$$salt);$type = "p\162o\x66\145s\163i\x6fna\x6c";$validate = x0b($type,$$vcv,$control,$url);if($validate=="va\154\x69\144\141\164\145\x64") { $$db->query("DE\114E\124\105 \x46R\x4f\115\040\166\x74\x69ge\x72\x5fem\x61\x6b\145rte\x6dpl\x61\164\x65s\x5f\x6c\151\143en\x73e");$$db->query("\x49\116\123\x45\x52\x54\040\x49N\124\117 v\x74ig\x65\x72\x5fem\x61k\145rt\x65\155pl\x61\164e\x73_l\151cen\163\145\x20\x56\101\x4c\125\x45\x53\050'".$type."','".$_REQUEST["\x6b\x65\x79"]."'\x29"); $$db->query("\x44EL\105TE\x20F\122\x4f\115 \166\164\x69g\x65\162\137\145\x6d\141\x6b\x65\162\164\x65\155p\154a\164e\x73_\166\145\162\x73\151o\156");$$db->query("INS\x45\122\x54\040IN\124\x4f\x20v\164i\147\x65\x72_e\155a\x6b\145\162t\145\x6d\160\154a\x74e\163\x5fve\162s\151\157n\x20\x56A\x4c\125\105\x53\x28'".$$vcv."','".$x0f("P".$x0f("p\162\157/".$$salt."\x2fE\x4d\x41\111\114\x4d\141\x6be\162"))."')");$smarty->assign("CUR\122\105\116\124\x5fS\x54\105\x50","\x32");$smarty->assign("ST\105\120","\x32");$smarty->assign("\124\117\x54\x41\x4c_\x53\x54EP\123","\x32");$smarty->assign("\x53\x54\x45\x50\x4e\x41ME",$mod["L\x42\114_\106IN\x49\123H"]);include("m\x6fdu\154e\x73\057E\115\x41I\x4c\x4d\141k\145r\x2f\105\x4d\101\x49\x4cMa\153e\x72.\160\x68\160");$EMAILMaker = new EmailMaker();$EMAILMaker->actualizeLinks(); }elseif($validate=="\x76a\x6c\x69\144ate\x5fer\x72") {$errTbl=array();$errTbl[]=$mod["\x4c\102\x4c\x5f\111\x4e\126\x41\x4c\x49\x44_\106O\x50\105N\137\x43U\x52L"];$smarty->assign("\x53\124\x45P","\x65r\x72o\162");$smarty->assign("\x49\x4eV\x41L\x49D","\x74\162\x75e");$smarty->assign("E\122ROR_TBL",$errTbl);}else {$errTbl=array();$errTbl[]="<sp\141\x6e\040sty\x6ce\x3d'\x63\157lo\162\x3ar\x65\x64\073\x66o\156\x74\055\x73ize\0721\x33\x70x\x3b\146\157nt-\x77\x65\151\147h\x74:\142\x6fld\x3b'\076".$mod["\114B\x4c\x5fI\x4eVA\114I\104\137KE\x59"]."\x3c\x2fs\x70\141n\x3e";$smarty->assign("\123\124\105\x50","\x65\x72ro\162");$smarty->assign("\x49NV\x41\114I\104","\x74\162\165e");$smarty->assign("E\122\x52OR_\x54BL",$errTbl);} $smarty->display("\x6dod\165\154\145\163\057E\x4dA\111\114\x4da\x6b\x65\162/i\x6es\164\141\154\154\056t\x70\154"); }elseif($_REQUEST["\x69\156\163ta\x6c\x6c\x74y\160\145"]=="\162e\x64\x69\x72e\143\x74\x5fr\x65\x63a\x6c\x63\x75\154\x61\x74\x65"){ echo "\074me\164a\x20\150\x74t\160\055\145q\165\151\166='r\x65\146r\145\x73\150'\x20c\x6f\156t\x65\x6e\x74\x3d'\x30\x3b\165\162\154\x3dinde\x78\056\160h\x70?\x6d\x6f\x64\x75\x6ce\075\x45\x4d\101I\x4cMake\x72\046action=i\156de\x78'\x20\x2f\x3e";}else{$smarty->assign("\x43\x55\122R\x45\x4e\124\137S\124\x45\120","\x31");$smarty->assign("\124O\124A\114\x5f\123\x54E\120\x53","2");$smarty->assign("\123\124\105\120","\x31");$smarty->display("\155\157\x64ul\x65\163\057\x45M\101\x49\x4c\115\x61\153\145\162/\x69\x6esta\x6cl\x2e\164\160l");}exit;

?>